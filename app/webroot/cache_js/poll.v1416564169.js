(function(a){inputCount=3;var b=function(b,d){a(b);var f=this;a.extend({param:"defaultValue"},d||{});this.init=function(c){"object"===typeof c&&(this.pollFormId=c.pollFormId,this.pollHolder=c.pollHolder,this.pollOptHolder=c.pollOptHolder,this.pollOptClass=c.pollOptClass,this.pollOptLimit=c.pollOptLimit,this.pollOptLimitCurrent=3);c=this.pollOptHolder+" "+this.pollOptClass+':last input[type="text"]';a(document).on("focus",c,function(){if(inputCount<f.pollOptLimit){a(Poll.pollOptHolder+" "+Poll.pollOptClass).last().clone(true,
true).appendTo(Poll.pollOptHolder);a(this).attr("placeholder","Option");a(this).attr("name","data[Post][poll_options][]");inputCount=inputCount+1}else a(this).attr("placeholder","Option")})};this.publicMethod=function(){}};a.fn.mypoll=function(e){return this.each(function(){a(this);return(new b(this,e)).init(e)})}})(jQuery);var Poll={pollFormId:"#frm_group_poll",pollHolder:"#ask_section",pollOptHolder:"#option_area",pollOptClass:".poll_inputarea",pollOptLimit:10};
$(document).on("click",".vote_for_poll",function(){var a=this,b=$(a).closest(".posting_area").find("#poll_id_hidden").val(),e=$(a).closest(".posting_area").find("input[name=optionsRadios]:checked").attr("id"),d=$(".btn_leave"),f=Ladda.create(a);f.start();$.ajax({type:"POST",url:"/post/api/updatePollVote/poll_id:"+b+"/option_id:"+e,dataType:"json",beforeSend:function(){$(a).attr("disabled","disabled");d.attr("disabled","disabled")},success:function(c){$(a).removeAttr("disabled");d.removeAttr("disabled");
f.stop();!0===c.success?($(a).attr("disabled","disabled"),$(a).closest(".posting_area").replaceWith(c.content),socket.emit("poll_update",{room:$("#PostPostedInRoom").val(),attendedUsers:c.attendedUsers,content:c.content,pollId:b}),setTimeout(function(){applyTimeAgo()},6E4),$("#post_container").hasClass("hide")&&($(".alert").hide(),$("#post_container").removeClass("hide"))):!0===c.error&&bootbox.alert(c.message,function(){window.location.reload();window.scrollTo(0,0)})}})});
$(document).on("keyup","#PollForm_title, .poll_input",function(){isPollDataPresent=!1;var a=""!==$.trim($(".poll_input").first().val())?!0:!1;isPollDataPresent=""!==$.trim($("#PollForm_title").val())&&a?!0:!1;changeShareBtnStatus()});
function resetPollForm(){var a=$("#option_area div.poll_inputarea").length;$("#PollForm_title").val("");$(".poll_input").val("");3<a&&$("#option_area").find("div").slice(-(a-1),-2).remove();$("#option_area div:last-child").children("input").attr("placeholder","add an option");inputCount=3;isPollDataPresent=!1}function showPollErrorMessage(a){alert(a.error_message);$("#PollFormErrorMessage").text(a.error_message).show()}
function validatePollForm(){var a=[],b=!1,e=0,d=" ";$("div#posting_errors").html("").hide();""!=$.trim($("#PollForm_title").val())&&null!=$.trim($("#PollForm_title").val())?($(".poll_input").each(function(){null!=$.trim($(this).val())&&""!=$.trim($(this).val())&&(e=$.inArray($(this).val(),a),-1==e?a.push($(this).val()):(b=!0,d="Options have duplicate values."))}),!0!==b&&2>a.length&&(b=!0,d="Please enter minimum two options.")):(b=!0,d="Please enter poll title.");return!0==b?($("div#posting_errors").html("<span>"+
d+"</span>").show(),!1):!0}$(document).on("click",".poll_options_radios",function(){$(this).closest(".posting_area").find(".vote_for_poll").removeAttr("disabled")});
$(document).on("click",".poll_popup_area",function(){var a=this,b=$(a).closest(".posting_area").find("#poll_id_hidden").val();$(".poll_result_modal").remove();$.ajax({type:"POST",url:"/post/api/getPollDetails/poll_id:"+b,dataType:"json",beforeSend:function(){$(a).removeClass("poll_popup_area")},success:function(b){$(a).addClass("poll_popup_area");$("#post_list").prepend(b.content);$("#pollPopupModal").modal("show")}})});