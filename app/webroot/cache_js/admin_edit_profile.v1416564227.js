!function(a){function b(){return new Date(Date.UTC.apply(Date,arguments))}var c=function(b,c){var h=this;this.element=a(b);this.language=c.language||this.element.data("date-language")||"en";this.language=this.language in e?this.language:this.language.split("-")[0];this.language=this.language in e?this.language:"en";this.isRTL=e[this.language].rtl||!1;this.format=d.parseFormat(c.format||this.element.data("date-format")||e[this.language].format||"mm/dd/yyyy");this.isInline=!1;this.isInput=this.element.is("input");
this.hasInput=(this.component=this.element.is(".date")?this.element.find(".add-on, .btn"):!1)&&this.element.find("input").length;this.component&&0===this.component.length&&(this.component=!1);this._attachEvents();this.forceParse=!0;"forceParse"in c?this.forceParse=c.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse"));this.picker=a(d.template).appendTo(this.isInline?this.element:"body").on({click:a.proxy(this.click,this),mousedown:a.proxy(this.mousedown,
this)});this.isInline?this.picker.addClass("datepicker-inline"):this.picker.addClass("datepicker-dropdown dropdown-menu");this.isRTL&&(this.picker.addClass("datepicker-rtl"),this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right"));a(document).on("mousedown",function(b){a(b.target).closest(".datepicker.datepicker-inline, .datepicker.datepicker-dropdown").length===0&&h.hide()});this.autoclose=!1;"autoclose"in c?this.autoclose=c.autoclose:"dateAutoclose"in this.element.data()&&
(this.autoclose=this.element.data("date-autoclose"));this.keyboardNavigation=!0;"keyboardNavigation"in c?this.keyboardNavigation=c.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation"));this.viewMode=this.startViewMode=0;switch(c.startView||this.element.data("date-start-view")){case 2:case "decade":this.viewMode=this.startViewMode=2;break;case 1:case "year":this.viewMode=this.startViewMode=1}this.minViewMode=c.minViewMode||
this.element.data("date-min-view-mode")||0;if("string"===typeof this.minViewMode)switch(this.minViewMode){case "months":this.minViewMode=1;break;case "years":this.minViewMode=2;break;default:this.minViewMode=0}this.viewMode=this.startViewMode=Math.max(this.startViewMode,this.minViewMode);this.todayBtn=c.todayBtn||this.element.data("date-today-btn")||!1;this.todayHighlight=c.todayHighlight||this.element.data("date-today-highlight")||!1;this.calendarWeeks=!1;"calendarWeeks"in c?this.calendarWeeks=c.calendarWeeks:
"dateCalendarWeeks"in this.element.data()&&(this.calendarWeeks=this.element.data("date-calendar-weeks"));this.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(a,b){return parseInt(b)+1});this.weekStart=(c.weekStart||this.element.data("date-weekstart")||e[this.language].weekStart||0)%7;this.weekEnd=(this.weekStart+6)%7;this.startDate=-Infinity;this.endDate=Infinity;this.daysOfWeekDisabled=[];this.setStartDate(c.startDate||this.element.data("date-startdate"));this.setEndDate(c.endDate||
this.element.data("date-enddate"));this.setDaysOfWeekDisabled(c.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled"));this.fillDow();this.fillMonths();this.update();this.showMode();this.isInline&&this.show()};c.prototype={constructor:c,_events:[],_attachEvents:function(){this._detachEvents();this.isInput?this._events=[[this.element,{focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this),keydown:a.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),
{focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this),keydown:a.proxy(this.keydown,this)}],[this.component,{click:a.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:a.proxy(this.show,this)}]];for(var b=0,c,d;b<this._events.length;b++)c=this._events[b][0],d=this._events[b][1],c.on(d)},_detachEvents:function(){for(var a=0,b,c;a<this._events.length;a++)b=this._events[a][0],c=this._events[a][1],b.off(c);this._events=[]},show:function(b){this.picker.show();
this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.update();this.place();a(window).on("resize",a.proxy(this.place,this));b&&b.preventDefault();this.element.trigger({type:"show",date:this.date})},hide:function(){!this.isInline&&this.picker.is(":visible")&&(this.picker.hide(),a(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||a(document).off("mousedown",this.hide),this.forceParse&&(this.isInput&&this.element.val()||
this.hasInput&&this.element.find("input").val())&&this.setValue(),this.element.trigger({type:"hide",date:this.date}))},remove:function(){this._detachEvents();this.picker.remove();delete this.element.data().datepicker;this.isInput||delete this.element.data().date},getDate:function(){var a=this.getUTCDate();return new Date(a.getTime()+6E4*a.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(a){this.setUTCDate(new Date(a.getTime()-6E4*a.getTimezoneOffset()))},setUTCDate:function(a){this.date=
a;this.setValue()},setValue:function(){var a=this.getFormattedDate();this.isInput?this.element.val(a):(this.component&&this.element.find("input").val(a),this.element.data("date",a))},getFormattedDate:function(a){void 0===a&&(a=this.format);return d.formatDate(this.date,a,this.language)},setStartDate:function(a){this.startDate=a||-Infinity;-Infinity!==this.startDate&&(this.startDate=d.parseDate(this.startDate,this.format,this.language));this.update();this.updateNavArrows()},setEndDate:function(a){this.endDate=
a||Infinity;Infinity!==this.endDate&&(this.endDate=d.parseDate(this.endDate,this.format,this.language));this.update();this.updateNavArrows()},setDaysOfWeekDisabled:function(b){this.daysOfWeekDisabled=b||[];a.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/));this.daysOfWeekDisabled=a.map(this.daysOfWeekDisabled,function(a){return parseInt(a,10)});this.update();this.updateNavArrows()},place:function(){if(!this.isInline){var b=parseInt(this.element.parents().filter(function(){return"auto"!=
a(this).css("z-index")}).first().css("z-index"))+10,c=this.component?this.component.parent().offset():this.element.offset(),d=this.component?this.component.outerHeight(!0):this.element.outerHeight(!0);this.picker.css({top:c.top+d,left:c.left,zIndex:b})}},update:function(){var a,b=!1;arguments&&arguments.length&&("string"===typeof arguments[0]||arguments[0]instanceof Date)?(a=arguments[0],b=!0):a=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val();this.date=
d.parseDate(a,this.format,this.language);b&&this.setValue();this.viewDate=this.date<this.startDate?new Date(this.startDate):this.date>this.endDate?new Date(this.endDate):new Date(this.date);this.fill()},fillDow:function(){var a=this.weekStart,b="<tr>";this.calendarWeeks&&(b+='<th class="cw">&nbsp;</th>',this.picker.find(".datepicker-days thead tr:first-child").prepend('<th class="cw">&nbsp;</th>'));for(;a<this.weekStart+7;)b+='<th class="dow">'+e[this.language].daysMin[a++%7]+"</th>";this.picker.find(".datepicker-days thead").append(b+
"</tr>")},fillMonths:function(){for(var a="",b=0;12>b;)a+='<span class="month">'+e[this.language].monthsShort[b++]+"</span>";this.picker.find(".datepicker-months td").html(a)},fill:function(){var c=new Date(this.viewDate),g=c.getUTCFullYear(),h=c.getUTCMonth(),c=-Infinity!==this.startDate?this.startDate.getUTCFullYear():-Infinity,i=-Infinity!==this.startDate?this.startDate.getUTCMonth():-Infinity,k=Infinity!==this.endDate?this.endDate.getUTCFullYear():Infinity,l=Infinity!==this.endDate?this.endDate.getUTCMonth():
Infinity,j=this.date&&this.date.valueOf(),o=new Date;this.picker.find(".datepicker-days thead th.switch").text(e[this.language].months[h]+" "+g);this.picker.find("tfoot th.today").text(e[this.language].today).toggle(!1!==this.todayBtn);this.updateNavArrows();this.fillMonths();var m=b(g,h-1,28,0,0,0,0),p=d.getDaysInMonth(m.getUTCFullYear(),m.getUTCMonth());m.setUTCDate(p);m.setUTCDate(p-(m.getUTCDay()-this.weekStart+7)%7);var t=new Date(m);t.setUTCDate(t.getUTCDate()+42);for(var t=t.valueOf(),p=[],
u;m.valueOf()<t;){if(m.getUTCDay()==this.weekStart&&(p.push("<tr>"),this.calendarWeeks)){u=new Date(+m+864E5*((this.weekStart-m.getUTCDay()-7)%7));u=new Date(+u+864E5*((11-u.getUTCDay())%7));var v=new Date(+(v=b(u.getUTCFullYear(),0,1))+864E5*((11-v.getUTCDay())%7));p.push('<td class="cw">'+((u-v)/864E5/7+1)+"</td>")}u="";if(m.getUTCFullYear()<g||m.getUTCFullYear()==g&&m.getUTCMonth()<h)u+=" old";else if(m.getUTCFullYear()>g||m.getUTCFullYear()==g&&m.getUTCMonth()>h)u+=" new";this.todayHighlight&&
(m.getUTCFullYear()==o.getFullYear()&&m.getUTCMonth()==o.getMonth()&&m.getUTCDate()==o.getDate())&&(u+=" today");j&&m.valueOf()==j&&(u+=" active");if(m.valueOf()<this.startDate||m.valueOf()>this.endDate||-1!==a.inArray(m.getUTCDay(),this.daysOfWeekDisabled))u+=" disabled";p.push('<td class="day'+u+'">'+m.getUTCDate()+"</td>");m.getUTCDay()==this.weekEnd&&p.push("</tr>");m.setUTCDate(m.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(p.join(""));v=this.date&&this.date.getUTCFullYear();
p=this.picker.find(".datepicker-months").find("th:eq(1)").text(g).end().find("span").removeClass("active");v&&v==g&&p.eq(this.date.getUTCMonth()).addClass("active");(g<c||g>k)&&p.addClass("disabled");g==c&&p.slice(0,i).addClass("disabled");g==k&&p.slice(l+1).addClass("disabled");p="";g=10*parseInt(g/10,10);i=this.picker.find(".datepicker-years").find("th:eq(1)").text(g+"-"+(g+9)).end().find("td");g-=1;for(l=-1;11>l;l++)p+='<span class="year'+(-1==l||10==l?" old":"")+(v==g?" active":"")+(g<c||g>k?
" disabled":"")+'">'+g+"</span>",g+=1;i.html(p)},updateNavArrows:function(){var a=new Date(this.viewDate),b=a.getUTCFullYear(),a=a.getUTCMonth();switch(this.viewMode){case 0:-Infinity!==this.startDate&&b<=this.startDate.getUTCFullYear()&&a<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"});Infinity!==this.endDate&&b>=this.endDate.getUTCFullYear()&&a>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):
this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:-Infinity!==this.startDate&&b<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),Infinity!==this.endDate&&b>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},click:function(c){c.preventDefault();c=a(c.target).closest("span, td, th");if(1==c.length)switch(c[0].nodeName.toLowerCase()){case "th":switch(c[0].className){case "switch":this.showMode(1);
break;case "prev":case "next":c=d.modes[this.viewMode].navStep*("prev"==c[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,c);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,c)}this.fill();break;case "today":c=new Date,c=b(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0),this.showMode(-2),this._setDate(c,"linked"==this.todayBtn?null:"view")}break;case "span":if(!c.is(".disabled")){this.viewDate.setUTCDate(1);if(c.is(".month")){var e=1,h=c.parent().find("span").index(c),
i=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(h);this.element.trigger({type:"changeMonth",date:this.viewDate});1==this.minViewMode&&this._setDate(b(i,h,e,0,0,0,0))}else i=parseInt(c.text(),10)||0,e=1,h=0,this.viewDate.setUTCFullYear(i),this.element.trigger({type:"changeYear",date:this.viewDate}),2==this.minViewMode&&this._setDate(b(i,h,e,0,0,0,0));this.showMode(-1);this.fill()}break;case "td":c.is(".day")&&!c.is(".disabled")&&(e=parseInt(c.text(),10)||1,i=this.viewDate.getUTCFullYear(),
h=this.viewDate.getUTCMonth(),c.is(".old")?0===h?(h=11,i-=1):h-=1:c.is(".new")&&(11==h?(h=0,i+=1):h+=1),this._setDate(b(i,h,e,0,0,0,0)))}},_setDate:function(a,b){if(!b||"date"==b)this.date=a;if(!b||"view"==b)this.viewDate=a;this.fill();this.setValue();this.element.trigger({type:"changeDate",date:this.date});var c;this.isInput?c=this.element:this.component&&(c=this.element.find("input"));c&&(c.change(),this.autoclose&&(!b||"date"==b)&&this.hide())},moveMonth:function(a,b){if(!b)return a;var c=new Date(a.valueOf()),
d=c.getUTCDate(),e=c.getUTCMonth(),l=Math.abs(b),j,b=0<b?1:-1;if(1==l){if(l=-1==b?function(){return c.getUTCMonth()==e}:function(){return c.getUTCMonth()!=j},j=e+b,c.setUTCMonth(j),0>j||11<j)j=(j+12)%12}else{for(var o=0;o<l;o++)c=this.moveMonth(c,b);j=c.getUTCMonth();c.setUTCDate(d);l=function(){return j!=c.getUTCMonth()}}for(;l();)c.setUTCDate(--d),c.setUTCMonth(j);return c},moveYear:function(a,b){return this.moveMonth(a,12*b)},dateWithinRange:function(a){return a>=this.startDate&&a<=this.endDate},
keydown:function(a){if(this.picker.is(":not(:visible)"))27==a.keyCode&&this.show();else{var b=!1,c,d,e;switch(a.keyCode){case 27:this.hide();a.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;c=37==a.keyCode?-1:1;a.ctrlKey?(d=this.moveYear(this.date,c),e=this.moveYear(this.viewDate,c)):a.shiftKey?(d=this.moveMonth(this.date,c),e=this.moveMonth(this.viewDate,c)):(d=new Date(this.date),d.setUTCDate(this.date.getUTCDate()+c),e=new Date(this.viewDate),e.setUTCDate(this.viewDate.getUTCDate()+
c));this.dateWithinRange(d)&&(this.date=d,this.viewDate=e,this.setValue(),this.update(),a.preventDefault(),b=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;c=38==a.keyCode?-1:1;a.ctrlKey?(d=this.moveYear(this.date,c),e=this.moveYear(this.viewDate,c)):a.shiftKey?(d=this.moveMonth(this.date,c),e=this.moveMonth(this.viewDate,c)):(d=new Date(this.date),d.setUTCDate(this.date.getUTCDate()+7*c),e=new Date(this.viewDate),e.setUTCDate(this.viewDate.getUTCDate()+7*c));this.dateWithinRange(d)&&
(this.date=d,this.viewDate=e,this.setValue(),this.update(),a.preventDefault(),b=!0);break;case 13:this.hide();a.preventDefault();break;case 9:this.hide()}if(b){this.element.trigger({type:"changeDate",date:this.date});var l;this.isInput?l=this.element:this.component&&(l=this.element.find("input"));l&&l.change()}}},showMode:function(a){a&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+a)));this.picker.find(">div").hide().filter(".datepicker-"+d.modes[this.viewMode].clsName).css("display",
"block");this.updateNavArrows()}};a.fn.datepicker=function(b){var d=Array.apply(null,arguments);d.shift();return this.each(function(){var e=a(this),i=e.data("datepicker"),k="object"==typeof b&&b;i||e.data("datepicker",i=new c(this,a.extend({},a.fn.datepicker.defaults,k)));"string"==typeof b&&"function"==typeof i[b]&&i[b].apply(i,d)})};a.fn.datepicker.defaults={};a.fn.datepicker.Constructor=c;var e=a.fn.datepicker.dates={en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),
daysShort:"Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysMin:"Su Mo Tu We Th Fr Sa Su".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),today:"Today"}},d={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(a){return 0===a%4&&0!==a%100||0===a%400},
getDaysInMonth:function(a,b){return[31,d.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(a){var b=a.replace(this.validParts,"\x00").split("\x00"),a=a.match(this.validParts);if(!b||!b.length||!a||0===a.length)throw Error("Invalid date format.");return{separators:b,parts:a}},parseDate:function(d,g,h){if(d instanceof Date)return d;if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(d)){for(var i=
/([\-+]\d+)([dmwy])/,k=d.match(/([\-+]\d+)([dmwy])/g),l,d=new Date,j=0;j<k.length;j++)switch(g=i.exec(k[j]),l=parseInt(g[1]),g[2]){case "d":d.setUTCDate(d.getUTCDate()+l);break;case "m":d=c.prototype.moveMonth.call(c.prototype,d,l);break;case "w":d.setUTCDate(d.getUTCDate()+7*l);break;case "y":d=c.prototype.moveYear.call(c.prototype,d,l)}return b(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),0,0,0)}var k=d&&d.match(this.nonpunctuation)||[],d=new Date,i={},o="yyyy yy M MM m mm d dd".split(" ");
l={yyyy:function(a,b){return a.setUTCFullYear(b)},yy:function(a,b){return a.setUTCFullYear(2E3+b)},m:function(a,b){for(b-=1;0>b;)b+=12;b%=12;for(a.setUTCMonth(b);a.getUTCMonth()!=b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}};var m;l.M=l.MM=l.mm=l.m;l.dd=l.d;var d=b(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0),p=g.parts.slice();k.length!=p.length&&(p=a(p).filter(function(b,c){return-1!==a.inArray(c,o)}).toArray());if(k.length==p.length){for(var j=0,t=p.length;j<
t;j++){m=parseInt(k[j],10);g=p[j];if(isNaN(m))switch(g){case "MM":m=a(e[h].months).filter(function(){var a=this.slice(0,k[j].length),b=k[j].slice(0,a.length);return a==b});m=a.inArray(m[0],e[h].months)+1;break;case "M":m=a(e[h].monthsShort).filter(function(){var a=this.slice(0,k[j].length),b=k[j].slice(0,a.length);return a==b}),m=a.inArray(m[0],e[h].monthsShort)+1}i[g]=m}for(j=0;j<o.length;j++)if(g=o[j],g in i&&!isNaN(i[g]))l[g](d,i[g])}return d},formatDate:function(b,c,d){d={d:b.getUTCDate(),D:e[d].daysShort[b.getUTCDay()],
DD:e[d].days[b.getUTCDay()],m:b.getUTCMonth()+1,M:e[d].monthsShort[b.getUTCMonth()],MM:e[d].months[b.getUTCMonth()],yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear()};d.dd=(10>d.d?"0":"")+d.d;d.mm=(10>d.m?"0":"")+d.m;for(var b=[],i=a.extend([],c.separators),k=0,l=c.parts.length;k<l;k++)i.length&&b.push(i.shift()),b.push(d[c.parts[k]]);return b.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',
contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};d.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+d.headTemplate+"<tbody></tbody>"+d.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+d.headTemplate+d.contTemplate+d.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+d.headTemplate+
d.contTemplate+d.footTemplate+"</table></div></div>";a.fn.datepicker.DPGlobal=d}(window.jQuery);
!function(){var a,b=function(){this.options_index=0;this.parsed=[]};a=(b.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName.toUpperCase()?this.add_group(a):this.add_option(a)},b.prototype.add_group=function(a){var b,d,f,g,h,i;b=this.parsed.length;this.parsed.push({array_index:b,group:!0,label:a.label,children:0,disabled:a.disabled});h=a.childNodes;i=[];f=0;for(g=h.length;g>f;f++)d=h[f],i.push(this.add_option(d,b,a.disabled));return i},b.prototype.add_option=function(a,b,d){return"OPTION"===
a.nodeName.toUpperCase()?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:!0===d?d:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},b);a.select_to_array=function(b){var e,d,f,g;e=new a;g=b.childNodes;
d=0;for(f=g.length;f>d;d++)b=g[d],e.add_node(b);return e.parsed};this.SelectParser=a}.call(this);
(function(){var a=function(b,c){this.form_field=b;this.options=null!=c?c:{};a.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup())};this.AbstractChosen=(a.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(c){return a.test_active_click(c)},this.activate_action=function(c){return a.activate_field(c)},this.active_field=
!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:
!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1},a.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||
a.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||a.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||a.default_no_result_text},a.prototype.mouse_enter=function(){return this.mouse_on_container=!0},a.prototype.mouse_leave=function(){return this.mouse_on_container=!1},a.prototype.input_focus=function(){var a=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return a.container_mousedown()},
50)}else if(!this.active_field)return this.activate_field()},a.prototype.input_blur=function(){var a=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return a.blur_test()},100))},a.prototype.result_add_option=function(a){var c,e;return a.dom_id=this.container_id+"_o_"+a.array_index,c=[],a.disabled||a.selected&&this.is_multiple||c.push("active-result"),!a.disabled||a.selected&&this.is_multiple||c.push("disabled-result"),a.selected&&c.push("result-selected"),null!=
a.group_array_index&&c.push("group-option"),""!==a.classes&&c.push(a.classes),e=""!==a.style.cssText?' style="'+a.style+'"':"",'<li id="'+a.dom_id+'" class="'+c.join(" ")+'"'+e+">"+a.html+"</li>"},a.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},
a.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},a.prototype.choices_count=function(){var a,c,e,d;if(null!=this.selected_option_count)return this.selected_option_count;this.selected_option_count=0;d=this.form_field.options;c=0;for(e=d.length;e>c;c++)a=d[c],a.selected&&(this.selected_option_count+=1);return this.selected_option_count},a.prototype.choices_click=function(a){return a.preventDefault(),this.results_showing||this.is_disabled?void 0:
this.results_show()},a.prototype.keyup_checker=function(a){var c,e;switch(c=null!=(e=a.which)?e:a.keyCode,this.search_field_scale(),c){case 8:if(this.is_multiple&&1>this.backstroke_length&&0<this.choices_count())return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;
default:return this.results_search()}},a.prototype.generate_field_id=function(){var a;return a=this.generate_random_id(),this.form_field.id=a,a},a.prototype.generate_random_char=function(){var a;return a=Math.floor(36*Math.random()),"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(a,a+1)},a.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},a.browser_is_supported=function(){var a;return"Microsoft Internet Explorer"===window.navigator.appName?
null!==(a=document.documentMode)&&8<=a:!0},a.default_multiple_text="Select Some Options",a.default_single_text="Select an Option",a.default_no_result_text="No results match",a)}).call(this);
(function(){var a,b,c,e={}.hasOwnProperty;c=this;a=jQuery;a.fn.extend({chosen:function(c){return AbstractChosen.browser_is_supported()?this.each(function(){var d;return d=a(this),d.hasClass("chzn-done")?void 0:d.data("chosen",new b(this,c))}):this}});var d=function(){return d.__super__.constructor.apply(this,arguments)},f=d,g=AbstractChosen,h=function(){this.constructor=f},i;for(i in g)e.call(g,i)&&(f[i]=g[i]);h.prototype=g.prototype;f.prototype=new h;f.__super__=g.prototype;b=(d.prototype.setup=
function(){return this.form_field_jq=a(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},d.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},d.prototype.set_up_html=function(){var b,c;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",b=["chzn-container"],b.push("chzn-container-"+(this.is_multiple?
"multi":"single")),this.inherit_select_classes&&this.form_field.className&&b.push(this.form_field.className),this.is_rtl&&b.push("chzn-rtl"),c={id:this.container_id,"class":b.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.container=a("<div />",c),this.is_multiple?this.container.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop"><ul class="chzn-results"></ul></div>'):
this.container.html('<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chzn-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),
this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},
d.prototype.register_observers=function(){var a=this;return this.container.mousedown(function(b){a.container_mousedown(b)}),this.container.mouseup(function(b){a.container_mouseup(b)}),this.container.mouseenter(function(b){a.mouse_enter(b)}),this.container.mouseleave(function(b){a.mouse_leave(b)}),this.search_results.mouseup(function(b){a.search_results_mouseup(b)}),this.search_results.mouseover(function(b){a.search_results_mouseover(b)}),this.search_results.mouseout(function(b){a.search_results_mouseout(b)}),
this.search_results.bind("mousewheel DOMMouseScroll",function(b){a.search_results_mousewheel(b)}),this.form_field_jq.bind("liszt:updated",function(b){a.results_update_field(b)}),this.form_field_jq.bind("liszt:activate",function(b){a.activate_field(b)}),this.form_field_jq.bind("liszt:open",function(b){a.container_mousedown(b)}),this.search_field.blur(function(b){a.input_blur(b)}),this.search_field.keyup(function(b){a.keyup_checker(b)}),this.search_field.keydown(function(b){a.keydown_checker(b)}),this.search_field.focus(function(b){a.input_focus(b)}),
this.is_multiple?this.search_choices.click(function(b){a.choices_click(b)}):this.container.click(function(a){a.preventDefault()})},d.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?
void 0:this.selected_item.bind("focus",this.activate_action))},d.prototype.container_mousedown=function(b){return this.is_disabled||(b&&"mousedown"===b.type&&!this.results_showing&&b.preventDefault(),null!=b&&a(b.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!b||a(b.target)[0]!==this.selected_item[0]&&!a(b.target).parents("a.chzn-single").length||(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).click(this.click_test_action),
this.results_show()),this.activate_field())},d.prototype.container_mouseup=function(a){return"ABBR"!==a.target.nodeName||this.is_disabled?void 0:this.results_reset(a)},d.prototype.search_results_mousewheel=function(a){var b,c,d;return b=-(null!=(c=a.originalEvent)?c.wheelDelta:NaN)||(null!=(d=a.originialEvent)?d.detail:void 0),null!=b?(a.preventDefault(),"DOMMouseScroll"===a.type&&(b*=40),this.search_results.scrollTop(b+this.search_results.scrollTop())):void 0},d.prototype.blur_test=function(){return!this.active_field&&
this.container.hasClass("chzn-container-active")?this.close_field():void 0},d.prototype.close_field=function(){return a(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},d.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),
this.search_field.focus()},d.prototype.test_active_click=function(b){return a(b.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},d.prototype.results_build=function(){var a,b,d,e,f;this.parsing=!0;this.selected_option_count=null;this.results_data=c.SelectParser.select_to_array(this.form_field);this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),
this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chzn-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chzn-container-single-nosearch")));a="";f=this.results_data;d=0;for(e=f.length;e>d;d++)b=f[d],b.group?a+=this.result_add_group(b):b.empty||(a+=this.result_add_option(b),b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(b.text),
this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(a),this.parsing=!1},d.prototype.result_add_group=function(b){return b.dom_id=this.container_id+"_g_"+b.array_index,'<li id="'+b.dom_id+'" class="group-result">'+a("<div />").text(b.label).html()+"</li>"},d.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){if(this.result_clear_highlight(),this.result_highlight=
a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight(),b>=e)return this.search_results.scrollTop(0<b-d?b-d:0);if(f>c)return this.search_results.scrollTop(c)}},d.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=
null},d.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(this.container.addClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results())},d.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),
this.container.removeClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this})),this.results_showing=!1},d.prototype.set_tab_index=function(){var a;return this.form_field_jq.attr("tabindex")?(a=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",a)):void 0},d.prototype.set_label_behavior=function(){var b=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&
(this.form_field_label=a("label[for='"+this.form_field.id+"']")),0<this.form_field_label.length?this.form_field_label.click(function(a){return b.is_multiple?b.container_mousedown(a):b.activate_field()}):void 0},d.prototype.show_search_field_default=function(){return this.is_multiple&&1>this.choices_count()&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},d.prototype.search_results_mouseup=
function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c.length?(this.result_highlight=c,this.result_select(b),this.search_field.focus()):void 0},d.prototype.search_results_mouseover=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c?this.result_do_highlight(c):void 0},d.prototype.search_results_mouseout=function(b){return a(b.target).hasClass("active-result")?
this.result_clear_highlight():void 0},d.prototype.choice_build=function(b){var c,d,e=this;return c=a("<li />",{"class":"search-choice"}).html("<span>"+b.html+"</span>"),b.disabled?c.addClass("search-choice-disabled"):(d=a("<a />",{href:"#","class":"search-choice-close",rel:b.array_index}),d.click(function(a){return e.choice_destroy_link_click(a)}),c.append(d)),this.search_container.before(c)},d.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),b.stopPropagation(),this.is_disabled?
void 0:this.choice_destroy(a(b.target))},d.prototype.choice_destroy=function(a){return this.result_deselect(a.attr("rel"))?(this.show_search_field_default(),this.is_multiple&&0<this.choices_count()&&1>this.search_field.val().length&&this.results_hide(),a.parents("li").first().remove(),this.search_field_scale()):void 0},d.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.selected_item.find("span").text(this.default_text),this.is_multiple||
this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},d.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},d.prototype.result_select=function(a){var b,c,d,e;return this.result_highlight?(b=this.result_highlight,c=b.attr("id"),this.result_clear_highlight(),this.is_multiple&&
this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(this.is_multiple?b.removeClass("active-result"):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=b,this.selected_item.removeClass("chzn-default")),b.addClass("result-selected"),e=c.substr(c.lastIndexOf("_")+1),d=this.results_data[e],d.selected=!0,this.form_field.options[d.options_index].selected=!0,this.selected_option_count=null,
this.is_multiple?this.choice_build(d):(this.selected_item.find("span").first().text(d.text),this.allow_single_deselect&&this.single_deselect_control_build()),(a.metaKey||a.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[d.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):
void 0},d.prototype.result_activate=function(a,b){return b.disabled?a.addClass("disabled-result"):this.is_multiple&&b.selected?a.addClass("result-selected"):a.addClass("active-result")},d.prototype.result_deactivate=function(a){return a.removeClass("active-result result-selected disabled-result")},d.prototype.result_deselect=function(b){var c,d;return d=this.results_data[b],this.form_field.options[d.options_index].disabled?!1:(d.selected=!1,this.form_field.options[d.options_index].selected=!1,this.selected_option_count=
null,c=a("#"+this.container_id+"_o_"+b),c.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[d.options_index].value}),this.search_field_scale(),!0)},d.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),
this.selected_item.addClass("chzn-single-with-deselect")):void 0},d.prototype.winnow_results=function(){var b,c,d,e,f,g,h,i,v,n,w,B,C,F,D,s,q;this.no_results_clear();i=0;v=this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html();f=RegExp((this.search_contains?"":"^")+v.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");B=RegExp(v.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");q=this.results_data;C=0;for(D=q.length;D>C;C++)if(c=q[C],!c.empty)if(c.group)a("#"+
c.dom_id).css("display","none");else{if(b=!1,h=c.dom_id,g=a("#"+h),f.test(c.html))b=!0,i+=1;else if(this.enable_split_word_search&&(0<=c.html.indexOf(" ")||0===c.html.indexOf("["))&&(e=c.html.replace(/\[|\]/g,"").split(" "),e.length)){F=0;for(s=e.length;s>F;F++)d=e[F],f.test(d)&&(b=!0,i+=1)}b?(v.length?(n=c.html.search(B),w=c.html.substr(0,n+v.length)+"</em>"+c.html.substr(n+v.length),w=w.substr(0,n)+"<em>"+w.substr(n)):w=c.html,g.html(w),this.result_activate(g,c),null!=c.group_array_index&&a("#"+
this.results_data[c.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&h===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(g))}return 1>i&&v.length?this.no_results(v):this.winnow_results_set_highlight()},d.prototype.winnow_results_set_highlight=function(){var a,b;return this.result_highlight||(b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first(),
null==a)?void 0:this.result_do_highlight(a)},d.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c)},d.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},d.prototype.keydown_arrow=function(){var a;return this.results_showing&&this.result_highlight?(a=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(a):
void 0:this.results_show()},d.prototype.keyup_arrow=function(){var a;return this.results_showing||this.is_multiple?this.result_highlight?(a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(0<this.choices_count()&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},d.prototype.keydown_backstroke=function(){var a;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):
(a=this.search_container.siblings("li.search-choice").last(),a.length&&!a.hasClass("search-choice-disabled")?(this.pending_backstroke=a,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},d.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},d.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,
this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a);this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault();this.keyup_arrow();break;case 40:a.preventDefault(),this.keydown_arrow()}},d.prototype.search_field_scale=function(){var b,c,d,e,f,g,i;if(this.is_multiple){f=0;d="position:absolute; left: -1000px; top: -1000px; display:none;";
e="font-size font-style font-weight font-family line-height text-transform letter-spacing".split(" ");g=0;for(i=e.length;i>g;g++)c=e[g],d+=c+":"+this.search_field.css(c)+";";return b=a("<div />",{style:d}),b.text(this.search_field.val()),a("body").append(b),f=b.width()+25,b.remove(),this.f_width||(this.f_width=this.container.outerWidth()),f>this.f_width-10&&(f=this.f_width-10),this.search_field.css({width:f+"px"})}},d.prototype.generate_random_id=function(){var b;for(b="sel"+this.generate_random_char()+
this.generate_random_char()+this.generate_random_char();0<a("#"+b).length;)b+=this.generate_random_char();return b},d);c.Chosen=b}).call(this);
var qq=function(a){return{hide:function(){return a.style.display="none",this},attach:function(b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c),function(){qq(a).detach(b,c)}},detach:function(b,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&a.detachEvent("on"+b,c),this},contains:function(b){return b?a===b?!0:a.contains?a.contains(b):!!(8&b.compareDocumentPosition(a)):!1},insertBefore:function(b){return b.parentNode.insertBefore(a,
b),this},remove:function(){return a.parentNode.removeChild(a),this},css:function(b){return null!=b.opacity&&"string"!=typeof a.style.opacity&&"undefined"!=typeof a.filters&&(b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"),qq.extend(a.style,b),this},hasClass:function(b){return RegExp("(^| )"+b+"( |$)").test(a.className)},addClass:function(b){return qq(a).hasClass(b)||(a.className+=" "+b),this},removeClass:function(b){return a.className=a.className.replace(RegExp("(^| )"+b+"( |$)")," ").replace(/^\s+|\s+$/g,
""),this},getByClass:function(b){var c,e=[];return a.querySelectorAll?a.querySelectorAll("."+b):(c=a.getElementsByTagName("*"),qq.each(c,function(a,c){qq(c).hasClass(b)&&e.push(c)}),e)},children:function(){for(var b=[],c=a.firstChild;c;)1===c.nodeType&&b.push(c),c=c.nextSibling;return b},setText:function(b){return a.innerText=b,a.textContent=b,this},clearText:function(){return qq(a).setText("")},hasAttribute:function(b){var c;return a.hasAttribute?a.hasAttribute(b)?null==/^false$/i.exec(a.getAttribute(b)):
!1:(c=a[b],void 0===c?!1:null==/^false$/i.exec(c))}}};qq.log=function(a,b){window.console&&(b&&"info"!==b?window.console[b]?window.console[b](a):window.console.log("<"+b+"> "+a):window.console.log(a))};qq.isObject=function(a){return a&&!a.nodeType&&"[object Object]"===Object.prototype.toString.call(a)};qq.isFunction=function(a){return"function"==typeof a};qq.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)||window.ArrayBuffer&&a.buffer&&a.buffer.constructor===ArrayBuffer};
qq.isItemList=function(a){return"[object DataTransferItemList]"===Object.prototype.toString.call(a)};qq.isNodeList=function(a){return"[object NodeList]"===Object.prototype.toString.call(a)||a.item&&a.namedItem};qq.isString=function(a){return"[object String]"===Object.prototype.toString.call(a)};qq.trimStr=function(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")};
qq.format=function(a){var b=Array.prototype.slice.call(arguments,1),c=a;return qq.each(b,function(a,b){c=c.replace(/{}/,b)}),c};qq.isFile=function(a){return window.File&&"[object File]"===Object.prototype.toString.call(a)};qq.isFileList=function(a){return window.FileList&&"[object FileList]"===Object.prototype.toString.call(a)};qq.isFileOrInput=function(a){return qq.isFile(a)||qq.isInput(a)};
qq.isInput=function(a){return window.HTMLInputElement&&"[object HTMLInputElement]"===Object.prototype.toString.call(a)&&a.type&&"file"===a.type.toLowerCase()?!0:a.tagName&&"input"===a.tagName.toLowerCase()&&a.type&&"file"===a.type.toLowerCase()?!0:!1};qq.isBlob=function(a){return window.Blob&&"[object Blob]"===Object.prototype.toString.call(a)};
qq.isXhrUploadSupported=function(){var a=document.createElement("input");return a.type="file",void 0!==a.multiple&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&"undefined"!=typeof qq.createXhrInstance().upload};qq.createXhrInstance=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(a){return qq.log("Neither XHR or ActiveX are supported!","error"),null}};qq.isFolderDropSupported=function(a){return a.items&&a.items[0].webkitGetAsEntry};
qq.isFileChunkingSupported=function(){return!qq.android()&&qq.isXhrUploadSupported()&&(void 0!==File.prototype.slice||void 0!==File.prototype.webkitSlice||void 0!==File.prototype.mozSlice)};qq.sliceBlob=function(a,b,c){return(a.slice||a.mozSlice||a.webkitSlice).call(a,b,c)};qq.arrayBufferToHex=function(a){var b="",a=new Uint8Array(a);return qq.each(a,function(a,e){var d=e.toString(16);2>d.length&&(d="0"+d);b+=d}),b};
qq.readBlobToHex=function(a,b,c){var a=qq.sliceBlob(a,b,b+c),e=new FileReader,d=new qq.Promise;return e.onload=function(){d.success(qq.arrayBufferToHex(e.result))},e.readAsArrayBuffer(a),d};qq.extend=function(a,b,c){return qq.each(b,function(b,d){c&&qq.isObject(d)?(void 0===a[b]&&(a[b]={}),qq.extend(a[b],d,!0)):a[b]=d}),a};qq.override=function(a,b){var c={},e=b(c);return qq.each(e,function(b,e){void 0!==a[b]&&(c[b]=a[b]);a[b]=e}),a};
qq.indexOf=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);var c=c||0,e=a.length;for(0>c&&(c+=e);e>c;c+=1)if(a.hasOwnProperty(c)&&a[c]===b)return c;return-1};qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random();return("x"==a?b:8|3&b).toString(16)})};qq.ie=function(){return-1!==navigator.userAgent.indexOf("MSIE")};qq.ie7=function(){return-1!==navigator.userAgent.indexOf("MSIE 7")};qq.ie10=function(){return-1!==navigator.userAgent.indexOf("MSIE 10")};
qq.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")};qq.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")};qq.firefox=function(){return-1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor};qq.windows=function(){return"Win32"===navigator.platform};qq.android=function(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")};qq.ios7=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 7_")};
qq.ios=function(){return-1!==navigator.userAgent.indexOf("iPad")||-1!==navigator.userAgent.indexOf("iPod")||-1!==navigator.userAgent.indexOf("iPhone")};qq.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};qq.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;b=a.firstChild;return a.removeChild(b),b}}();
qq.each=function(a,b){var c,e;if(a)if(window.Storage&&a.constructor===window.Storage)for(c=0;c<a.length&&(e=b(a.key(c),a.getItem(a.key(c))),!1!==e);c++);else if(qq.isArray(a)||qq.isItemList(a)||qq.isNodeList(a))for(c=0;c<a.length&&(e=b(c,a[c]),!1!==e);c++);else if(qq.isString(a))for(c=0;c<a.length&&(e=b(c,a.charAt(c)),!1!==e);c++);else for(c in a)if(Object.prototype.hasOwnProperty.call(a,c)&&(e=b(c,a[c]),!1===e))break};
qq.bind=function(a,b){if(qq.isFunction(a)){var c=Array.prototype.slice.call(arguments,2);return function(){var e=qq.extend([],c);return arguments.length&&(e=e.concat(Array.prototype.slice.call(arguments))),a.apply(b,e)}}throw Error("first parameter must be a function!");};
qq.obj2url=function(a,b,c){var e=[],d="&",f=function(a,c){var d=b?/\[\]$/.test(b)?b:b+"["+c+"]":c;"undefined"!==d&&"undefined"!==c&&e.push("object"==typeof a?qq.obj2url(a,d,!0):"[object Function]"===Object.prototype.toString.call(a)?encodeURIComponent(d)+"="+encodeURIComponent(a()):encodeURIComponent(d)+"="+encodeURIComponent(a))};return!c&&b?(d=/\?/.test(b)?/\?$/.test(b)?"":"&":"?",e.push(b),e.push(qq.obj2url(a))):"[object Array]"===Object.prototype.toString.call(a)&&"undefined"!=typeof a?qq.each(a,
function(a,b){f(b,a)}):"undefined"!=typeof a&&null!==a&&"object"==typeof a?qq.each(a,function(a,b){f(b,a)}):e.push(encodeURIComponent(b)+"="+encodeURIComponent(a)),b?e.join(d):e.join(d).replace(/^&/,"").replace(/%20/g,"+")};qq.obj2FormData=function(a,b,c){return b||(b=new FormData),qq.each(a,function(a,d){a=c?c+"["+a+"]":a;qq.isObject(d)?qq.obj2FormData(d,b,a):qq.isFunction(d)?b.append(a,d()):b.append(a,d)}),b};
qq.obj2Inputs=function(a,b){var c;return b||(b=document.createElement("form")),qq.obj2FormData(a,{append:function(a,d){c=document.createElement("input");c.setAttribute("name",a);c.setAttribute("value",d);b.appendChild(c)}}),b};qq.setCookie=function(a,b,c){var e=new Date,d="";c&&(e.setTime(e.getTime()+864E5*c),d="; expires="+e.toGMTString());document.cookie=a+"="+b+d+"; path=/"};
qq.getCookie=function(a){var b,c=a+"=",a=document.cookie.split(";");return qq.each(a,function(a,d){for(var f=d;" "==f.charAt(0);)f=f.substring(1,f.length);return 0===f.indexOf(c)?(b=f.substring(c.length,f.length),!1):void 0}),b};qq.getCookieNames=function(a){var b=document.cookie.split(";"),c=[];return qq.each(b,function(b,d){var d=qq.trimStr(d),f=d.indexOf("=");d.match(a)&&c.push(d.substr(0,f))}),c};qq.deleteCookie=function(a){qq.setCookie(a,"",-1)};
qq.areCookiesEnabled=function(){var a="qqCookieTest:"+1E5*Math.random();return qq.setCookie(a,1),qq.getCookie(a)?(qq.deleteCookie(a),!0):!1};qq.parseJson=function(a){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(a):eval("("+a+")")};qq.getExtension=function(a){var b=a.lastIndexOf(".")+1;return 0<b?a.substr(b,a.length-b):void 0};
qq.DisposeSupport=function(){var a=[];return{dispose:function(){var b;do(b=a.shift())&&b();while(b)},attach:function(){this.addDisposer(qq(arguments[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(b){a.push(b)}}};qq.version="4.0.2";
qq.supportedFeatures=function(){var a,b,c,e,d,f,g,h,i,k,l,j,o,m=!0;try{o=document.createElement("input"),o.type="file",qq(o).hide(),o.disabled&&(m=!1)}catch(p){m=!1}return a=m,b=a&&qq.isXhrUploadSupported(),c=b&&qq.chrome()&&void 0!==navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/),e=b&&qq.isFileChunkingSupported(),d=b&&e&&qq.areCookiesEnabled(),f=b&&qq.chrome()&&void 0!==navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/),g=a&&(void 0!==window.postMessage||b),i=window.XMLHttpRequest?
void 0!==qq.createXhrInstance().withCredentials:!1,h=void 0!==window.XDomainRequest,k=window.XMLHttpRequest&&void 0!==qq.createXhrInstance().withCredentials?!0:void 0!==window.XDomainRequest,l=void 0!==document.createElement("input").webkitdirectory,j=b&&void 0!==window.FileReader,{uploading:a,ajaxUploading:b,fileDrop:b,folderDrop:c,chunking:e,resume:d,uploadCustomHeaders:b,uploadNonMultipart:b,itemSizeValidation:b,uploadViaPaste:f,progressBar:b,uploadCors:g,deleteFileCorsXhr:i,deleteFileCorsXdr:h,
deleteFileCors:k,canDetermineSize:b,folderSelection:l,imagePreviews:j}}();
qq.Promise=function(){var a,b,c=[],e=[],d=[],f=0;return{then:function(d,h){return 0===f?(d&&c.push(d),h&&e.push(h)):-1===f&&h?h.apply(null,b):d&&d.apply(null,a),this},done:function(c){return 0===f?d.push(c):c.apply(null,void 0===b?a:b),this},success:function(){return f=1,a=arguments,c.length&&qq.each(c,function(b,c){c.apply(null,a)}),d.length&&qq.each(d,function(b,c){c.apply(null,a)}),this},failure:function(){return f=-1,b=arguments,e.length&&qq.each(e,function(a,c){c.apply(null,b)}),d.length&&qq.each(d,
function(a,c){c.apply(null,b)}),this}}};qq.isPromise=function(a){return a&&a.then&&a.done};
qq.UploadButton=function(a){function b(){var a=document.createElement("input");return a.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME,e),f.multiple&&a.setAttribute("multiple",""),f.folders&&qq.supportedFeatures.folderSelection&&a.setAttribute("webkitdirectory",""),f.acceptFiles&&a.setAttribute("accept",f.acceptFiles),a.setAttribute("type","file"),a.setAttribute("name",f.name),qq(a).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),
f.element.appendChild(a),d.attach(a,"change",function(){f.onChange(a)}),d.attach(a,"mouseover",function(){qq(f.element).addClass(f.hoverClass)}),d.attach(a,"mouseout",function(){qq(f.element).removeClass(f.hoverClass)}),d.attach(a,"focus",function(){qq(f.element).addClass(f.focusClass)}),d.attach(a,"blur",function(){qq(f.element).removeClass(f.focusClass)}),window.attachEvent&&a.setAttribute("tabIndex","-1"),a}var c,e,d=new qq.DisposeSupport,f={element:null,multiple:!1,acceptFiles:null,folders:!1,
name:"qqfile",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};return qq.extend(f,a),e=qq.getUniqueId(),qq(f.element).css({position:"relative",overflow:"hidden",direction:"ltr"}),c=b(),{getInput:function(){return c},getButtonId:function(){return e},setMultiple:function(a){a!==f.multiple&&(a?c.setAttribute("multiple",""):c.removeAttribute("multiple"))},setAcceptFiles:function(a){a!==f.acceptFiles&&c.setAttribute("accept",a)},reset:function(){c.parentNode&&
qq(c).remove();qq(f.element).removeClass(f.focusClass);c=b()}}};qq.UploadButton.BUTTON_ID_ATTR_NAME="qq-button-id";
qq.UploadData=function(a){var b=[],c={},e={},d={};return{added:function(f){var g=a.getUuid(f),h=a.getName(f),i=a.getSize(f),k=qq.status.SUBMITTING,h=b.push({id:f,name:h,originalName:h,uuid:g,size:i,status:k})-1;c[f]=h;e[g]=h;void 0===d[k]&&(d[k]=[]);d[k].push(h);a.onStatusChange(f,void 0,k)},retrieve:function(a){if(qq.isObject(a)&&b.length)if(void 0!==a.id)if(a=a.id,qq.isArray(a))var g=[],a=(qq.each(a,function(a,d){g.push(b[c[d]])}),g);else a=b[c[a]];else if(void 0!==a.uuid)if(a=a.uuid,qq.isArray(a))var h=
[],a=(qq.each(a,function(a,c){h.push(b[e[c]])}),h);else a=b[e[a]];else if(a.status)var i=[],a=[].concat(a.status),a=(qq.each(a,function(a,c){var e=d[c];void 0!==e&&qq.each(e,function(a,c){i.push(b[c])})}),i);else a=void 0;else a=qq.extend([],b,!0);return a},reset:function(){b=[];c={};e={};d={}},setStatus:function(e,g){var h=c[e],i=b[h].status,k=qq.indexOf(d[i],h);d[i].splice(k,1);b[h].status=g;void 0===d[g]&&(d[g]=[]);d[g].push(h);a.onStatusChange(e,i,g)},uuidChanged:function(a,d){var h=c[a],i=b[h].uuid;
b[h].uuid=d;e[d]=h;delete e[i]},nameChanged:function(a,d){b[c[a]].name=d}}};qq.status={SUBMITTING:"submitting",SUBMITTED:"submitted",REJECTED:"rejected",QUEUED:"queued",CANCELED:"canceled",UPLOADING:"uploading",UPLOAD_RETRYING:"retrying upload",UPLOAD_SUCCESSFUL:"upload successful",UPLOAD_FAILED:"upload failed",DELETE_FAILED:"delete failed",DELETING:"deleting",DELETED:"deleted"};
qq.basePublicApi={log:function(a,b){!this._options.debug||b&&"info"!==b?b&&"info"!==b&&qq.log("[FineUploader "+qq.version+"] "+a,b):qq.log("[FineUploader "+qq.version+"] "+a)},setParams:function(a,b){null==b?this._options.request.params=a:this._paramsStore.setParams(a,b)},setDeleteFileParams:function(a,b){null==b?this._options.deleteFile.params=a:this._deleteFileParamsStore.setParams(a,b)},setEndpoint:function(a,b){null==b?this._options.request.endpoint=a:this._endpointStore.setEndpoint(a,b)},getInProgress:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,
qq.status.UPLOAD_RETRYING,qq.status.QUEUED]}).length},getNetUploads:function(){return this._netUploaded},uploadStoredFiles:function(){var a;if(0===this._storedIds.length)this._itemError("noFilesError");else for(;this._storedIds.length;)a=this._storedIds.shift(),this._handler.upload(a)},clearStoredFiles:function(){this._storedIds=[]},retry:function(a){return this._manualRetry(a)},cancel:function(a){this._handler.cancel(a)},cancelAll:function(){var a=[],b=this;qq.extend(a,this._storedIds);qq.each(a,
function(a,e){b.cancel(e)});this._handler.cancelAll()},reset:function(){this.log("Resetting uploader...");this._handler.reset();this._storedIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._thumbnailUrls=[];qq.each(this._buttons,function(a,b){b.reset()});this._paramsStore.reset();this._endpointStore.reset();this._netUploaded=this._netUploadedOrQueued=0;this._uploadData.reset();this._buttonIdsForFileIds=[];this._pasteHandler&&this._pasteHandler.reset()},addFiles:function(a,
b,c){var e,d,f,g=[];if(a){qq.isFileList(a)||(a=[].concat(a));for(e=0;e<a.length;e+=1)if(d=a[e],qq.isFileOrInput(d))if(qq.isInput(d)&&qq.supportedFeatures.ajaxUploading)for(f=0;f<d.files.length;f++)g.push(d.files[f]);else g.push(d);else this.log(d+" is not a File or INPUT element!  Ignoring!","warn");this.log("Received "+g.length+" files or inputs.");this._prepareItemsForUpload(g,b,c)}},addBlobs:function(a,b,c){if(a){var a=[].concat(a),e=[],d=this;qq.each(a,function(a,b){qq.isBlob(b)&&!qq.isFileOrInput(b)?
e.push({blob:b,name:d._options.blobs.defaultName}):qq.isObject(b)&&b.blob&&b.name?e.push(b):d.log("addBlobs: entry at index "+a+" is not a Blob or a BlobData object","error")});this._prepareItemsForUpload(e,b,c)}else this.log("undefined or non-array parameter passed into addBlobs","error")},getUuid:function(a){return this._handler.getUuid(a)},setUuid:function(a,b){return this._handler.setUuid(a,b)},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(a){return this._handler.getSize(a)},
getName:function(a){return this._handler.getName(a)},setName:function(a,b){this._handler.setName(a,b);this._uploadData.nameChanged(a,b)},getFile:function(a){return this._handler.getFile(a)},deleteFile:function(a){this._onSubmitDelete(a)},setDeleteFileEndpoint:function(a,b){null==b?this._options.deleteFile.endpoint=a:this._deleteFileEndpointStore.setEndpoint(a,b)},doesExist:function(a){return this._handler.isValid(a)},getUploads:function(a){return this._uploadData.retrieve(a)},getButton:function(a){return this._getButton(this._buttonIdsForFileIds[a])},
drawThumbnail:function(a,b,c,e){if(this._imageGenerator){var d=this._thumbnailUrls[a],c={scale:0<c,maxSize:0<c?c:null};return!e&&qq.supportedFeatures.imagePreviews&&(d=this.getFile(a)),null==d?(new qq.Promise).failure(b,"File or URL not found."):this._imageGenerator.generate(d,b,c)}}};
qq.basePrivateApi={_generateExtraButtonSpecs:function(){var a=this;this._extraButtonSpecs={};qq.each(this._options.extraButtons,function(b,c){var e=c.multiple,d=qq.extend({},a._options.validation,!0),f=qq.extend({},c);void 0===e&&(e=a._options.multiple);f.validation&&qq.extend(d,c.validation,!0);qq.extend(f,{multiple:e,validation:d},!0);a._initExtraButton(f)})},_initExtraButton:function(a){var b=this._createUploadButton({element:a.element,multiple:a.multiple,accept:a.validation.acceptFiles,folders:a.folders});
this._extraButtonSpecs[b.getButtonId()]=a},_getButtonId:function(a){var b,c;if(a&&!a.blob&&!qq.isBlob(a)){if(qq.isFile(a))return a.qqButtonId;if("input"===a.tagName.toLowerCase()&&"file"===a.type.toLowerCase())return a.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);if(b=a.getElementsByTagName("input"),qq.each(b,function(a,b){return"file"===b.getAttribute("type")?(c=b,!1):void 0}),c)return c.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME)}},_annotateWithButtonId:function(a,b){qq.isFile(a)&&(a.qqButtonId=
this._getButtonId(b))},_getButton:function(a){var b=this._extraButtonSpecs[a];return b?b.element:a===this._defaultButtonId?this._options.button:void 0},_handleCheckedCallback:function(a){var b=this,c=a.callback();return qq.isPromise(c)?(this.log(a.name+" - waiting for "+a.name+" promise to be fulfilled for "+a.identifier),c.then(function(c){b.log(a.name+" promise success for "+a.identifier);a.onSuccess(c)},function(){a.onFailure?(b.log(a.name+" promise failure for "+a.identifier),a.onFailure()):b.log(a.name+
" promise failure for "+a.identifier)})):(!1!==c?a.onSuccess(c):a.onFailure?(this.log(a.name+" - return value was 'false' for "+a.identifier+".  Invoking failure callback."),a.onFailure()):this.log(a.name+" - return value was 'false' for "+a.identifier+".  Will not proceed."),c)},_createUploadButton:function(a){var b=this,c=new qq.UploadButton({element:a.element,folders:a.folders,name:this._options.request.inputName,multiple:(void 0===a.multiple?this._options.multiple:a.multiple)&&qq.supportedFeatures.ajaxUploading,
acceptFiles:a.accept||this._options.validation.acceptFiles,onChange:function(a){b._onInputChange(a)},hoverClass:this._options.classes.buttonHover,focusClass:this._options.classes.buttonFocus});return this._disposeSupport.addDisposer(function(){c.dispose()}),b._buttons.push(c),c},_createUploadHandler:function(a,b){var c=this,e={debug:this._options.debug,maxConnections:this._options.maxConnections,inputName:this._options.request.inputName,cors:this._options.cors,demoMode:this._options.demoMode,paramsStore:this._paramsStore,
endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:qq.bind(c.log,c),onProgress:function(a,b,e,h){c._onProgress(a,b,e,h);c._options.callbacks.onProgress(a,b,e,h)},onComplete:function(a,b,e,h){var i=c._onComplete(a,b,e,h);qq.isPromise(i)?i.done(function(){c._options.callbacks.onComplete(a,b,e,h)}):c._options.callbacks.onComplete(a,b,e,h)},onCancel:function(a,b){return c._handleCheckedCallback({name:"onCancel",callback:qq.bind(c._options.callbacks.onCancel,
c,a,b),onSuccess:qq.bind(c._onCancel,c,a,b),identifier:a})},onUpload:function(a,b){c._onUpload(a,b);c._options.callbacks.onUpload(a,b)},onUploadChunk:function(a,b,e){c._options.callbacks.onUploadChunk(a,b,e)},onResume:function(a,b,e){return c._options.callbacks.onResume(a,b,e)},onAutoRetry:function(){return c._onAutoRetry.apply(c,arguments)},onUuidChanged:function(a,b){c._uploadData.uuidChanged(a,b)}};return qq.each(this._options.request,function(a,b){e[a]=b}),a&&qq.each(a,function(a,b){e[a]=b}),
new qq.UploadHandler(e,b)},_createDeleteHandler:function(){var a=this;return new qq.DeleteFileAjaxRequestor({method:this._options.deleteFile.method,maxConnections:this._options.maxConnections,uuidParamName:this._options.request.uuidName,customHeaders:this._options.deleteFile.customHeaders,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,demoMode:this._options.demoMode,cors:this._options.cors,log:qq.bind(a.log,a),onDelete:function(b){a._onDelete(b);a._options.callbacks.onDelete(b)},
onDeleteComplete:function(b,c,e){a._onDeleteComplete(b,c,e);a._options.callbacks.onDeleteComplete(b,c,e)}})},_createPasteHandler:function(){var a=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:qq.bind(a.log,a),pasteReceived:function(b){a._handleCheckedCallback({name:"onPasteReceived",callback:qq.bind(a._options.callbacks.onPasteReceived,a,b),onSuccess:qq.bind(a._handlePasteSuccess,a,b),identifier:"pasted image"})}}})},_createUploadDataTracker:function(){var a=
this;return new qq.UploadData({getName:function(b){return a.getName(b)},getUuid:function(b){return a.getUuid(b)},getSize:function(b){return a.getSize(b)},onStatusChange:function(b,c,e){a._onUploadStatusChange(b,c,e);a._options.callbacks.onStatusChange(b,c,e)}})},_onUploadStatusChange:function(){},_handlePasteSuccess:function(a,b){var c=a.type.split("/")[1],e=b;null==e&&(e=this._options.paste.defaultName);this.addBlobs({name:e+("."+c),blob:a})},_preventLeaveInProgress:function(){var a=this;this._disposeSupport.attach(window,
"beforeunload",function(b){if(a.getInProgress())return b=b||window.event,b.returnValue=a._options.messages.onLeave,a._options.messages.onLeave})},_onSubmit:function(){this._netUploadedOrQueued++},_onProgress:function(){},_onComplete:function(a,b,c,e){return c.success?(c.thumbnailUrl&&(this._thumbnailUrls[a]=c.thumbnailUrl),this._netUploaded++,this._uploadData.setStatus(a,qq.status.UPLOAD_SUCCESSFUL)):(this._netUploadedOrQueued--,this._uploadData.setStatus(a,qq.status.UPLOAD_FAILED)),this._maybeParseAndSendUploadError(a,
b,c,e),c.success?!0:!1},_onCancel:function(a){this._netUploadedOrQueued--;clearTimeout(this._retryTimeouts[a]);var b=qq.indexOf(this._storedIds,a);!this._options.autoUpload&&0<=b&&this._storedIds.splice(b,1);this._uploadData.setStatus(a,qq.status.CANCELED)},_isDeletePossible:function(){return qq.DeleteFileAjaxRequestor&&this._options.deleteFile.enabled?this._options.cors.expected?qq.supportedFeatures.deleteFileCorsXhr?!0:qq.supportedFeatures.deleteFileCorsXdr&&this._options.cors.allowXdr?!0:!1:!0:
!1},_onSubmitDelete:function(a,b,c){var e,d=this.getUuid(a);return b&&(e=qq.bind(b,this,a,d,c)),this._isDeletePossible()?this._handleCheckedCallback({name:"onSubmitDelete",callback:qq.bind(this._options.callbacks.onSubmitDelete,this,a),onSuccess:e||qq.bind(this._deleteHandler.sendDelete,this,a,d,c),identifier:a}):(this.log("Delete request ignored for ID "+a+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onDelete:function(a){this._uploadData.setStatus(a,
qq.status.DELETING)},_onDeleteComplete:function(a,b,c){var e=this._handler.getName(a);c?(this._uploadData.setStatus(a,qq.status.DELETE_FAILED),this.log("Delete request for '"+e+"' has failed.","error"),void 0===b.withCredentials?this._options.callbacks.onError(a,e,"Delete request failed",b):this._options.callbacks.onError(a,e,"Delete request failed with response code "+b.status,b)):(this._netUploadedOrQueued--,this._netUploaded--,this._handler.expunge(a),this._uploadData.setStatus(a,qq.status.DELETED),
this.log("Delete request for '"+e+"' has succeeded."))},_onUpload:function(a){this._uploadData.setStatus(a,qq.status.UPLOADING)},_onInputChange:function(a){var b;if(qq.supportedFeatures.ajaxUploading){for(b=0;b<a.files.length;b++)this._annotateWithButtonId(a.files[b],a);this.addFiles(a.files)}else 0<a.value.length&&this.addFiles(a);qq.each(this._buttons,function(a,b){b.reset()})},_onBeforeAutoRetry:function(a,b){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+
b+"...")},_onAutoRetry:function(a,b,c,e,d){var f=this;return f._preventRetries[a]=c[f._options.retry.preventRetryResponseProperty],f._shouldAutoRetry(a,b,c)?(f._maybeParseAndSendUploadError.apply(f,arguments),f._options.callbacks.onAutoRetry(a,b,f._autoRetries[a]+1),f._onBeforeAutoRetry(a,b),f._retryTimeouts[a]=setTimeout(function(){f.log("Retrying "+b+"...");f._autoRetries[a]++;f._uploadData.setStatus(a,qq.status.UPLOAD_RETRYING);d?d(a):f._handler.retry(a)},1E3*f._options.retry.autoAttemptDelay),
!0):void 0},_shouldAutoRetry:function(a){return!this._preventRetries[a]&&this._options.retry.enableAuto?(void 0===this._autoRetries[a]&&(this._autoRetries[a]=0),this._autoRetries[a]<this._options.retry.maxAutoAttempts):!1},_onBeforeManualRetry:function(a){var b=this._options.validation.itemLimit;if(this._preventRetries[a])return this.log("Retries are forbidden for id "+a,"warn"),!1;if(this._handler.isValid(a)){var c=this._handler.getName(a);return!1===this._options.callbacks.onManualRetry(a,c)?!1:
0<b&&this._netUploadedOrQueued+1>b?(this._itemError("retryFailTooManyItems"),!1):(this.log("Retrying upload for '"+c+"' (id: "+a+")..."),!0)}return this.log("'"+a+"' is not a valid file ID","error"),!1},_manualRetry:function(a,b){return this._onBeforeManualRetry(a)?(this._netUploadedOrQueued++,this._uploadData.setStatus(a,qq.status.UPLOAD_RETRYING),b?b(a):this._handler.retry(a),!0):void 0},_maybeParseAndSendUploadError:function(a,b,c,e){if(!c.success)if(e&&200!==e.status&&!c.error)this._options.callbacks.onError(a,
b,"XHR returned response code "+e.status,e);else this._options.callbacks.onError(a,b,c.error?c.error:this._options.text.defaultResponseError,e)},_prepareItemsForUpload:function(a,b,c){var e=this._getValidationDescriptors(a),d=this._getButtonId(a[0]),d=this._getButton(d);this._handleCheckedCallback({name:"onValidateBatch",callback:qq.bind(this._options.callbacks.onValidateBatch,this,e,d),onSuccess:qq.bind(this._onValidateBatchCallbackSuccess,this,e,a,b,c,d),identifier:"batch validation"})},_upload:function(a,
b,c){var a=this._handler.add(a),e=this._handler.getName(a);this._uploadData.added(a);b&&this.setParams(b,a);c&&this.setEndpoint(c,a);this._handleCheckedCallback({name:"onSubmit",callback:qq.bind(this._options.callbacks.onSubmit,this,a,e),onSuccess:qq.bind(this._onSubmitCallbackSuccess,this,a,e),onFailure:qq.bind(this._fileOrBlobRejected,this,a,e),identifier:a})},_onSubmitCallbackSuccess:function(a){var b;this._uploadData.setStatus(a,qq.status.SUBMITTED);(b=qq.supportedFeatures.ajaxUploading?this._handler.getFile(a).qqButtonId:
this._getButtonId(this._handler.getInput(a)))&&(this._buttonIdsForFileIds[a]=b);this._onSubmit.apply(this,arguments);this._onSubmitted.apply(this,arguments);this._options.callbacks.onSubmitted.apply(this,arguments);this._options.autoUpload?this._handler.upload(a)||this._uploadData.setStatus(a,qq.status.QUEUED):this._storeForLater(a)},_onSubmitted:function(){},_storeForLater:function(a){this._storedIds.push(a)},_onValidateBatchCallbackSuccess:function(a,b,c,e,d){var f,g=this._options.validation.itemLimit,
h=this._netUploadedOrQueued+a.length;0===g||g>=h?0<b.length?this._handleCheckedCallback({name:"onValidate",callback:qq.bind(this._options.callbacks.onValidate,this,a[0],d),onSuccess:qq.bind(this._onValidateCallbackSuccess,this,b,0,c,e),onFailure:qq.bind(this._onValidateCallbackFailure,this,b,0,c,e),identifier:"Item '"+b[0].name+"', size: "+b[0].size}):this._itemError("noFilesError"):(f=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,h).replace(/\{itemLimit\}/g,g),this._batchError(f))},
_onValidateCallbackSuccess:function(a,b,c,e){var d=b+1,f=this._getValidationDescriptor(a[b]),g=!1;this._validateFileOrBlobData(a[b],f)&&(g=!0,this._upload(a[b],c,e));this._maybeProcessNextItemAfterOnValidateCallback(g,a,d,c,e)},_onValidateCallbackFailure:function(a,b,c,e){b+=1;this._fileOrBlobRejected(void 0,a[0].name);this._maybeProcessNextItemAfterOnValidateCallback(!1,a,b,c,e)},_maybeProcessNextItemAfterOnValidateCallback:function(a,b,c,e,d){var f=this;b.length>c&&(a||!this._options.validation.stopOnFirstInvalidFile)&&
setTimeout(function(){var a=f._getValidationDescriptor(b[c]);f._handleCheckedCallback({name:"onValidate",callback:qq.bind(f._options.callbacks.onValidate,f,b[c]),onSuccess:qq.bind(f._onValidateCallbackSuccess,f,b,c,e,d),onFailure:qq.bind(f._onValidateCallbackFailure,f,b,c,e,d),identifier:"Item '"+a.name+"', size: "+a.size})},0)},_validateFileOrBlobData:function(a,b){var c=b.name,e=b.size,d=this._getButtonId(a),d=(d=this._extraButtonSpecs[d])?d.validation:this._options.validation,f=!0;return qq.isFileOrInput(a)&&
!this._isAllowedExtension(d.allowedExtensions,c)?(this._itemError("typeError",c,a),f=!1):0===e?(this._itemError("emptyError",c,a),f=!1):e&&d.sizeLimit&&e>d.sizeLimit?(this._itemError("sizeError",c,a),f=!1):e&&e<d.minSizeLimit&&(this._itemError("minSizeError",c,a),f=!1),f||this._fileOrBlobRejected(void 0,c),f},_fileOrBlobRejected:function(a){void 0!==a&&this._uploadData.setStatus(a,qq.status.REJECTED)},_itemError:function(a,b,c){var e,d=this._options.messages[a],f=[],g=[].concat(b),a=g[0],c=this._getButtonId(c),
c=(c=this._extraButtonSpecs[c])?c.validation:this._options.validation;qq.each(c.allowedExtensions,function(a,b){qq.isString(b)&&f.push(b)});var b=f.join(", ").toLowerCase(),h=this._options.formatFileName(a),d=d.replace("{file}",h),d=d.replace("{extensions}",b),b=this._formatSize(c.sizeLimit),d=d.replace("{sizeLimit}",b),c=this._formatSize(c.minSizeLimit),d=d.replace("{minSizeLimit}",c);return e=d.match(/(\{\w+\})/g),null!==e&&qq.each(e,function(a,b){d=d.replace(b,g[a])}),this._options.callbacks.onError(null,
a,d,void 0),d},_batchError:function(a){this._options.callbacks.onError(null,null,a,void 0)},_isAllowedExtension:function(a,b){var c=!1;return a.length?(qq.each(a,function(a,d){if(qq.isString(d)&&null!=b.match(RegExp("\\."+d+"$","i")))return c=!0,!1}),c):!0},_formatSize:function(a){var b=-1;do a/=1E3,b++;while(999<a);return Math.max(a,0.1).toFixed(1)+this._options.text.sizeSymbols[b]},_wrapCallbacks:function(){var a,b;a=this;b=function(b,c,f){try{return c.apply(a,f)}catch(g){a.log("Caught exception in '"+
b+"' callback - "+g.message,"error")}};for(var c in this._options.callbacks)!function(){var e,d;e=c;d=a._options.callbacks[e];a._options.callbacks[e]=function(){return b(e,d,arguments)}}()},_parseFileOrBlobDataName:function(a){return qq.isFileOrInput(a)?a.value?a.value.replace(/.*(\/|\\)/,""):null!==a.fileName&&void 0!==a.fileName?a.fileName:a.name:a.name},_parseFileOrBlobDataSize:function(a){var b;return qq.isFileOrInput(a)?void 0===a.value&&(b=null!==a.fileSize&&void 0!==a.fileSize?a.fileSize:a.size):
b=a.blob.size,b},_getValidationDescriptor:function(a){var b={},c=this._parseFileOrBlobDataName(a),a=this._parseFileOrBlobDataSize(a);return b.name=c,void 0!==a&&(b.size=a),b},_getValidationDescriptors:function(a){var b=this,c=[];return qq.each(a,function(a,d){c.push(b._getValidationDescriptor(d))}),c},_createParamsStore:function(a){var b={},c=this;return{setParams:function(a,c){var f={};qq.extend(f,a);b[c]=f},getParams:function(e){var d={};return null!=e&&b[e]?qq.extend(d,b[e]):qq.extend(d,c._options[a].params),
d},remove:function(a){return delete b[a]},reset:function(){b={}}}},_createEndpointStore:function(a){var b={},c=this;return{setEndpoint:function(a,c){b[c]=a},getEndpoint:function(e){return null!=e&&b[e]?b[e]:c._options[a].endpoint},remove:function(a){return delete b[a]},reset:function(){b={}}}},_handleCameraAccess:function(){if(this._options.camera.ios&&qq.ios()){var a=this._options.camera.button,b=a?this._getButtonId(a):this._defaultButtonId,c=b?this._extraButtonSpecs[b]:this._options;c.multiple=
!1;null===c.validation.acceptFiles?c.validation.acceptFiles="image/*;capture=camera":c.validation.acceptFiles+=",image/*;capture=camera";qq.each(this._buttons,function(a,d){return d.getButtonId()===b?(d.setMultiple(c.multiple),d.setAcceptFiles(c.acceptFiles),!1):void 0})}}};
qq.FineUploaderBasic=function(a){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},paramsInBody:!0,customHeaders:{},forceMultipart:!0,inputName:"qqfile",uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize",filenameParam:"qqfilename"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0,acceptFiles:null},callbacks:{onSubmit:function(){},onSubmitted:function(){},
onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onResume:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidateBatch:function(){},onValidate:function(){},onSubmitDelete:function(){},onDelete:function(){},onDeleteComplete:function(){},onPasteReceived:function(){},onStatusChange:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",
minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},
classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,partSize:2E6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(a){return void 0!==a&&33<a.length&&(a=a.slice(0,19)+"..."+a.slice(-14)),a},text:{defaultResponseError:"Upload failure reason unknown",
sizeSymbols:"kB MB GB TB PB EB".split(" ")},deleteFile:{enabled:!1,method:"DELETE",endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1,allowXdr:!1},blobs:{defaultName:"misc_data"},paste:{targetElement:null,defaultName:"pasted_image"},camera:{ios:!1,button:null},extraButtons:[]};qq.extend(this._options,a,!0);this._buttons=[];this._extraButtonSpecs={};this._buttonIdsForFileIds=[];this._wrapCallbacks();this._disposeSupport=new qq.DisposeSupport;this._storedIds=
[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._thumbnailUrls=[];this._netUploaded=this._netUploadedOrQueued=0;this._uploadData=this._createUploadDataTracker();this._paramsStore=this._createParamsStore("request");this._deleteFileParamsStore=this._createParamsStore("deleteFile");this._endpointStore=this._createEndpointStore("request");this._deleteFileEndpointStore=this._createEndpointStore("deleteFile");this._handler=this._createUploadHandler();this._deleteHandler=qq.DeleteFileAjaxRequestor&&
this._createDeleteHandler();this._options.button&&(this._defaultButtonId=this._createUploadButton({element:this._options.button}).getButtonId());this._generateExtraButtonSpecs();this._handleCameraAccess();this._options.paste.targetElement&&(qq.PasteSupport?this._pasteHandler=this._createPasteHandler():qq.log("Paste support module not found","info"));this._preventLeaveInProgress();this._imageGenerator=qq.ImageGenerator&&new qq.ImageGenerator(qq.bind(this.log,this))};
qq.FineUploaderBasic.prototype=qq.basePublicApi;qq.extend(qq.FineUploaderBasic.prototype,qq.basePrivateApi);
qq.AjaxRequestor=function(a){function b(){return j.method.toUpperCase()}function c(a){return j.cors.expected&&void 0===a.withCredentials}function e(a,b){var c=l[a].xhr;if(!c&&!b){if(j.cors.expected)var d,c=((window.XMLHttpRequest||window.ActiveXObject)&&(d=qq.createXhrInstance(),void 0===d.withCredentials&&(d=new XDomainRequest)),d);else c=qq.createXhrInstance();l[a].xhr=c}return c}function d(a){var b,c=qq.indexOf(k,a),d=j.maxConnections;delete l[a];k.splice(c,1);k.length>=d&&d>c&&(b=k[d-1],g(b))}
function f(a,f){var i=e(a),k=b(),g=!0===f;d(a);g?h(k+" request for "+a+" has failed","error"):c(i)||0<=qq.indexOf(j.successfulResponseCodes[b()],i.status)||(g=!0,h(k+" request for "+a+" has failed - response code "+i.status,"error"));j.onComplete(a,i,g)}function g(a){var d=e(a),k=b(),g,u;g=l[a].onDemandParams;var v=j.mandatedParams;g=(j.paramsStore.getParams&&(u=j.paramsStore.getParams(a)),g&&qq.each(g,function(a,b){u=u||{};u[a]=b}),v&&qq.each(v,function(a,b){u=u||{};u[a]=b}),u);v=l[a].body;j.onSend(a);
var n,w=j.endpointStore.getEndpoint(a);n=l[a].addToPath;n=(void 0!=n&&(w+="/"+n),i&&g?qq.obj2url(g,w):w);c(d)?(d.onload=function(){f(a)},d.onerror=function(){f(a,!0)}):d.onreadystatechange=function(){4===e(a).readyState&&f(a)};d.open(k,n,!0);j.cors.expected&&j.cors.sendCredentials&&!c(d)&&(d.withCredentials=!0);var B=e(a),w=j.customHeaders;n=l[a].additionalHeaders||{};var C=b(),F={};if(c(B)){var D;if(D=j.cors.expected)if(D=0<=qq.indexOf(["GET","POST","HEAD"],b())){var s=!1;D=!(qq.each(s,function(a,
b){return qq.indexOf(["Accept","Accept-Language","Content-Language","Content-Type"],b)<0?(s=true,false):void 0}),s)}D||(B.setRequestHeader("X-Requested-With","XMLHttpRequest"),B.setRequestHeader("Cache-Control","no-cache"))}!j.contentType||"POST"!==C&&"PUT"!==C||c(B)||B.setRequestHeader("Content-Type",j.contentType);c(B)||(qq.extend(F,w),qq.extend(F,n),qq.each(F,function(a,b){B.setRequestHeader(a,b)}));h("Sending "+k+" request for "+a);v?d.send(v):i||!g?d.send():g&&0<=j.contentType.toLowerCase().indexOf("application/x-www-form-urlencoded")?
d.send(qq.obj2url(g,"")):g&&0<=j.contentType.toLowerCase().indexOf("application/json")?d.send(JSON.stringify(g)):d.send(g)}var h,i,k=[],l=[],j={validMethods:["POST"],method:"POST",contentType:"application/x-www-form-urlencoded",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},mandatedParams:{},successfulResponseCodes:{DELETE:[200,202,204],POST:[200,204]},cors:{expected:!1,sendCredentials:!1},log:function(){},onSend:function(){},onComplete:function(){},onCancel:function(){}};if(qq.extend(j,
a),h=j.log,0>qq.indexOf(j.validMethods,b()))throw Error("'"+b()+"' is not a supported method for this type of request!");return i="GET"===b()||"DELETE"===b(),{send:function(a,b,c,d,e){l[a]={addToPath:b,onDemandParams:c,additionalHeaders:d,body:e};k.push(a)<=j.maxConnections&&g(a)},cancel:function(a){var f=e(a,!0),i=b();return f?(c(f)?(f.onerror=null,f.onload=null):f.onreadystatechange=null,f.abort(),d(a),h("Cancelled "+i+" for "+a),j.onCancel(a),!0):!1},getMethod:function(){return b()}}};
qq.UploadHandler=function(a,b){function c(a){var b,a=qq.indexOf(i,a),c=d.maxConnections;0<=a&&(i.splice(a,1),i.length>=c&&c>a&&(b=i[c-1],g.upload(b)))}function e(a){f("Cancelling "+a);d.paramsStore.remove(a);c(a)}var d,f,g,h,i=[];d={debug:!1,forceMultipart:!0,paramsInBody:!1,paramsStore:{},endpointStore:{},filenameParam:"qqfilename",cors:{expected:!1,sendCredentials:!1},maxConnections:3,uuidParam:"qquuid",totalFileSizeParam:"qqtotalfilesize",chunking:{enabled:!1,partSize:2E6,paramNames:{partIndex:"qqpartindex",
partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onAutoRetry:function(){},onResume:function(){},onUuidChanged:function(){}};qq.extend(d,a);f=d.log;h={add:function(a){return g.add(a)},upload:function(a){return i.push(a)<=d.maxConnections?
(g.upload(a),!0):!1},retry:function(a){return 0<=qq.indexOf(i,a)?g.upload(a,!0):this.upload(a)},cancel:function(a){var b=g.cancel(a);qq.isPromise(b)?b.then(function(){e(a)}):!1!==b&&e(a)},cancelAll:function(){var a=this,b=[];qq.extend(b,i);qq.each(b,function(b,c){a.cancel(c)});i=[]},getName:function(a){return g.getName(a)},setName:function(a,b){g.setName(a,b)},getSize:function(a){return g.getSize?g.getSize(a):void 0},getFile:function(a){return g.getFile?g.getFile(a):void 0},getInput:function(a){return g.getInput?
g.getInput(a):void 0},reset:function(){f("Resetting upload handler");h.cancelAll();i=[];g.reset()},expunge:function(a){return g.expunge(a)},getUuid:function(a){return g.getUuid(a)},setUuid:function(a,b){return g.setUuid(a,b)},isValid:function(a){return g.isValid(a)},getResumableFilesData:function(){return g.getResumableFilesData?g.getResumableFilesData():[]},getThirdPartyFileId:function(a){return g.getThirdPartyFileId&&h.isValid(a)?g.getThirdPartyFileId(a):void 0}};g=new (b?qq[b]:qq)["UploadHandler"+
(qq.supportedFeatures.ajaxUploading?"Xhr":"Form")](d,c,d.onUuidChanged,f);return h};
qq.UploadHandlerFormApi=function(a,b,c,e,d,f,g){var h,i=qq.getUniqueId(),k=new qq.WindowReceiveMessage({log:g}),l={},j={},o={};return qq.extend(a,{getIframeName:function(a){return a+"_"+i},createIframe:function(b){var b=a.getIframeName(b),c=qq.toElement('<iframe src="javascript:false;" name="'+b+'" />');return c.setAttribute("id",b),c.style.display="none",document.body.appendChild(c),c},parseJsonResponse:function(a,b){var c;try{c=qq.parseJson(b),void 0!==c.newUuid&&h.setUuid(a,c.newUuid)}catch(d){g("Error when attempting to parse iframe upload response ("+
d.message+")","error"),c={}}return c},initFormForUpload:function(a){var b=a.endpoint,c=a.params,d=a.paramsInBody,e=a.targetName,a=qq.toElement('<form method="'+a.method+'" enctype="multipart/form-data"></form>'),f=b;return d?qq.obj2Inputs(c,a):f=qq.obj2url(c,b),a.setAttribute("action",f),a.setAttribute("target",e),a.style.display="none",document.body.appendChild(a),a},attachLoadEvent:function(d,e){var f;if(c){var i=d.id,h=i.split("_")[0];l[b[h].uuid]=e;j[h]=qq(d).attach("load",function(){b[h].input&&
(g("Received iframe load event for CORS upload request (iframe name "+i+")"),o[i]=setTimeout(function(){var a="No valid message received from loaded iframe for iframe name "+i;g(a,"error");e({error:a})},1E3))});k.receiveMessage(i,function(b){g("Received the following window message: '"+b+"'");var c,d=i.split("_")[0],d=a.parseJsonResponse(d,b),e=d.uuid;e&&l[e]?(g("Handling response for iframe name "+i),clearTimeout(o[i]),delete o[i],a.detachLoadEvent(i),c=l[e],delete l[e],k.stopReceivingMessages(i),
c(d)):e||g("'"+b+"' does not contain a UUID - ignoring.")})}else j[d.id]=qq(d).attach("load",function(){if(g("Received response for "+d.id),d.parentNode){try{if(d.contentDocument&&d.contentDocument.body&&"false"==d.contentDocument.body.innerHTML)return}catch(a){g("Error when attempting to access iframe during handling of upload response ("+a.message+")","error"),f={success:!1}}e(f)}})},detachLoadEvent:function(a){void 0!==j[a]&&(j[a](),delete j[a])}}),h={add:function(a){var c=b.push({input:a})-1;
return a.setAttribute("name",e),b[c].uuid=qq.getUniqueId(),a.parentNode&&qq(a).remove(),c},getName:function(a){return void 0!==b[a].newName?b[a].newName:h.isValid(a)?b[a].input.value.replace(/.*(\/|\\)/,""):(g(a+" is not a valid item ID.","error"),void 0)},getInput:function(a){return b[a].input},setName:function(a,c){b[a].newName=c},isValid:function(a){return void 0!==b[a]&&void 0!==b[a].input},reset:function(){b.length=0},expunge:function(d){delete j[d];delete b[d];c&&(clearTimeout(o[d]),delete o[d],
k.stopReceivingMessages(d));(d=document.getElementById(a.getIframeName(d)))&&(d.setAttribute("src","java"+String.fromCharCode(115)+"cript:false;"),qq(d).remove())},getUuid:function(a){return b[a].uuid},cancel:function(a){var b=d(a,h.getName(a));return qq.isPromise(b)?b.then(function(){h.expunge(a)}):!1!==b?(h.expunge(a),!0):!1},upload:function(){},setUuid:function(a,c){g("Server requested UUID change from '"+b[a].uuid+"' to '"+c+"'");b[a].uuid=c;f(a,c)}}};
qq.UploadHandlerXhrApi=function(a,b,c,e,d,f,g){var h;return qq.extend(a,{createXhr:function(a){var c=qq.createXhrInstance();return b[a].xhr=c,c},getTotalChunks:function(a){if(c)return a=h.getSize(a),Math.ceil(a/c.partSize)},getChunkData:function(b,d){var e=c.partSize,f=h.getSize(b),g=h.getFile(b),m=e*d,e=m+e>=f?f:m+e,f=a.getTotalChunks(b);return{part:d,start:m,end:e,count:f,blob:g.slice?g.slice(m,e):g.mozSlice?g.mozSlice(m,e):g.webkitSlice?g.webkitSlice(m,e):void 0,size:e-m}},getChunkDataForCallback:function(a){return{partIndex:a.part,
startByte:a.start+1,endByte:a.end,totalParts:a.count}}}),h={add:function(a){var c=qq.getUniqueId();if(qq.isFile(a))a=b.push({file:a})-1;else{if(!qq.isBlob(a.blob))throw Error("Passed obj in not a File or BlobData (in qq.UploadHandlerXhr)");a=b.push({blobData:a})-1}return b[a].uuid=c,a},getName:function(a){if(h.isValid(a)){var c=b[a].file,d=b[a].blobData,a=b[a].newName;return void 0!==a?a:c?null!==c.fileName&&void 0!==c.fileName?c.fileName:c.name:d.name}g(a+" is not a valid item ID.","error")},setName:function(a,
c){b[a].newName=c},getSize:function(a){a=b[a].file||b[a].blobData.blob;return qq.isFileOrInput(a)?null!=a.fileSize?a.fileSize:a.size:a.size},getFile:function(a){return b[a]?b[a].file||b[a].blobData.blob:void 0},isValid:function(a){return void 0!==b[a]},reset:function(){b.length=0},expunge:function(a){var c=b[a].xhr;c&&(c.onreadystatechange=null,c.abort());delete b[a]},getUuid:function(a){return b[a].uuid},upload:function(a,b){return e(a,b)},cancel:function(a){var b=d(a,h.getName(a));return qq.isPromise(b)?
b.then(function(){h.expunge(a)}):!1!==b?(h.expunge(a),!0):!1},setUuid:function(a,c){g("Server requested UUID change from '"+b[a].uuid+"' to '"+c+"'");b[a].uuid=c;f(a,c)}}};
qq.WindowReceiveMessage=function(a){var b={};return qq.extend({log:function(){}},a),{receiveMessage:function(a,e){var d=function(a){e(a.data)};window.postMessage?b[a]=qq(window).attach("message",d):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(a){window.postMessage&&(a=b[a])&&a()}}};
qq.uiPublicApi={clearStoredFiles:function(){this._parent.prototype.clearStoredFiles.apply(this,arguments);this._templating.clearFiles()},addExtraDropzone:function(a){this._dnd&&this._dnd.setupExtraDropzone(a)},removeExtraDropzone:function(a){return this._dnd?this._dnd.removeDropzone(a):void 0},getItemByFileId:function(a){return this._templating.getFileContainer(a)},reset:function(){this._parent.prototype.reset.apply(this,arguments);this._templating.reset();!this._options.button&&this._templating.getButton()&&
(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton()}).getButtonId());this._dnd&&(this._dnd.dispose(),this._dnd=this._setupDragAndDrop());this._filesInBatchAddedToUi=this._totalFilesInBatch=0;this._setupClickAndEditEventHandlers()}};
qq.uiPrivateApi={_getButton:function(a){var b=this._parent.prototype._getButton.apply(this,arguments);return b||a===this._defaultButtonId&&(b=this._templating.getButton()),b},_removeFileItem:function(a){this._templating.removeFile(a)},_setupClickAndEditEventHandlers:function(){this._deleteRetryOrCancelClickHandler=qq.DeleteRetryOrCancelClickHandler&&this._bindDeleteRetryOrCancelClickEvent();this._focusinEventSupported=!qq.firefox();this._isEditFilenameEnabled()&&(this._filenameClickHandler=this._bindFilenameClickEvent(),
this._filenameInputFocusInHandler=this._bindFilenameInputFocusInEvent(),this._filenameInputFocusHandler=this._bindFilenameInputFocusEvent())},_setupDragAndDrop:function(){var a=this,b=this._options.dragAndDrop.extraDropzones,c=this._templating,e=c.getDropZone();return e&&b.push(e),new qq.DragAndDrop({dropZoneElements:b,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){c.showDropProcessing()},processingDroppedFilesComplete:function(b){c.hideDropProcessing();
b&&a.addFiles(b)},dropError:function(b,c){a._itemError(b,c)},dropLog:function(b,c){a.log(b,c)}}})},_bindDeleteRetryOrCancelClickEvent:function(){var a=this;return new qq.DeleteRetryOrCancelClickHandler({templating:this._templating,log:function(b,c){a.log(b,c)},onDeleteFile:function(b){a.deleteFile(b)},onCancel:function(b){a.cancel(b)},onRetry:function(b){qq(a._templating.getFileContainer(b)).removeClass(a._classes.retryable);a.retry(b)},onGetName:function(b){return a.getName(b)}})},_isEditFilenameEnabled:function(){return this._templating.isEditFilenamePossible()&&
!this._options.autoUpload&&qq.FilenameClickHandler&&qq.FilenameInputFocusHandler&&qq.FilenameInputFocusHandler},_filenameEditHandler:function(){var a=this,b=this._templating;return{templating:b,log:function(b,e){a.log(b,e)},onGetUploadStatus:function(b){return a.getUploads({id:b}).status},onGetName:function(b){return a.getName(b)},onSetName:function(c,e){var d=a._options.formatFileName(e);b.updateFilename(c,d);a.setName(c,e)},onEditingStatusChange:function(a,e){var d=qq(b.getEditInput(a)),f=qq(b.getFileContainer(a));
e?(d.addClass("qq-editing"),b.hideFilename(a),b.hideEditIcon(a)):(d.removeClass("qq-editing"),b.showFilename(a),b.showEditIcon(a));f.addClass("qq-temp").removeClass("qq-temp")}}},_onUploadStatusChange:function(a,b,c){this._isEditFilenameEnabled()&&this._templating.getFileContainer(a)&&c!==qq.status.SUBMITTED&&(this._templating.markFilenameEditable(a),this._templating.hideEditIcon(a))},_bindFilenameInputFocusInEvent:function(){var a=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusInHandler(a)},
_bindFilenameInputFocusEvent:function(){var a=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusHandler(a)},_bindFilenameClickEvent:function(){var a=qq.extend({},this._filenameEditHandler());return new qq.FilenameClickHandler(a)},_leaving_document_out:function(a){return(qq.chrome()||qq.safari()&&qq.windows())&&0==a.clientX&&0==a.clientY||qq.firefox()&&!a.relatedTarget},_storeForLater:function(a){this._parent.prototype._storeForLater.apply(this,arguments);this._templating.hideSpinner(a)},
_onSubmit:function(a,b){this._parent.prototype._onSubmit.apply(this,arguments);this._addToList(a,b)},_onSubmitted:function(a){this._isEditFilenameEnabled()&&(this._templating.markFilenameEditable(a),this._templating.showEditIcon(a),this._focusinEventSupported||this._filenameInputFocusHandler.addHandler(this._templating.getEditInput(a)))},_onProgress:function(a,b,c,e){this._parent.prototype._onProgress.apply(this,arguments);this._templating.updateProgress(a,c,e);c===e?(this._templating.hideCancel(a),
this._templating.setStatusText(a,this._options.text.waitingForResponse),this._displayFileSize(a)):this._displayFileSize(a,c,e)},_onComplete:function(a,b,c){function e(b){f.setStatusText(a);qq(f.getFileContainer(a)).removeClass(g._classes.retrying);f.hideProgress(a);(!g._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&f.hideCancel(a);f.hideSpinner(a);b.success?(g._isDeletePossible()&&f.showDelete(a),qq(f.getFileContainer(a)).addClass(g._classes.success),g._maybeUpdateThumbnail(a)):
(qq(f.getFileContainer(a)).addClass(g._classes.fail),g._templating.isRetryPossible()&&!g._preventRetries[a]&&qq(f.getFileContainer(a)).addClass(g._classes.retryable),g._controlFailureTextDisplay(a,b))}var d=this._parent.prototype._onComplete.apply(this,arguments),f=this._templating,g=this;return qq.isPromise(d)?d.done(function(a){e(a)}):e(c),d},_onUpload:function(a){var b=this._parent.prototype._onUpload.apply(this,arguments);return this._templating.showSpinner(a),b},_onCancel:function(a){this._parent.prototype._onCancel.apply(this,
arguments);this._removeFileItem(a)},_onBeforeAutoRetry:function(a){var b,c,e;this._parent.prototype._onBeforeAutoRetry.apply(this,arguments);this._showCancelLink(a);this._templating.hideProgress(a);this._options.retry.showAutoRetryNote&&(b=this._autoRetries[a]+1,c=this._options.retry.maxAutoAttempts,e=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,b),e=e.replace(/\{maxAuto\}/g,c),this._templating.setStatusText(a,e),qq(this._templating.getFileContainer(a)).addClass(this._classes.retrying))},
_onBeforeManualRetry:function(a){return this._parent.prototype._onBeforeManualRetry.apply(this,arguments)?(this._templating.resetProgress(a),qq(this._templating.getFileContainer(a)).removeClass(this._classes.fail),this._templating.setStatusText(a),this._templating.showSpinner(a),this._showCancelLink(a),!0):(qq(this._templating.getFileContainer(a)).addClass(this._classes.retryable),!1)},_onSubmitDelete:function(a){var b=qq.bind(this._onSubmitDeleteSuccess,this);this._parent.prototype._onSubmitDelete.call(this,
a,b)},_onSubmitDeleteSuccess:function(){this._options.deleteFile.forceConfirm?this._showDeleteConfirm.apply(this,arguments):this._sendDeleteRequest.apply(this,arguments)},_onDeleteComplete:function(a,b,c){this._parent.prototype._onDeleteComplete.apply(this,arguments);this._templating.hideSpinner(a);c?(this._templating.setStatusText(a,this._options.deleteFile.deletingFailedText),this._templating.showDelete(a)):this._removeFileItem(a)},_sendDeleteRequest:function(a){this._templating.hideDelete(a);this._templating.showSpinner(a);
this._templating.setStatusText(a,this._options.deleteFile.deletingStatusText);this._deleteHandler.sendDelete.apply(this,arguments)},_showDeleteConfirm:function(a){var b;b=this._handler.getName(a);b=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,b);var c=(this.getUuid(a),arguments),e=this;b=this._options.showConfirm(b);qq.isPromise(b)?b.then(function(){e._sendDeleteRequest.apply(e,c)}):!1!==b&&e._sendDeleteRequest.apply(e,c)},_addToList:function(a,b){var c,e=0;this._options.disableCancelForFormUploads&&
!qq.supportedFeatures.ajaxUploading&&this._templating.disableCancel();this._options.display.prependFiles&&(1<this._totalFilesInBatch&&0<this._filesInBatchAddedToUi&&(e=this._filesInBatchAddedToUi-1),c={index:e});this._options.multiple||(this._handler.cancelAll(),this._clearList());this._templating.addFile(a,this._options.formatFileName(b),c);this._templating.generatePreview(a,this.getFile(a));this._filesInBatchAddedToUi+=1;this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading&&
this._displayFileSize(a)},_clearList:function(){this._templating.clearFiles();this.clearStoredFiles()},_displayFileSize:function(a,b,c){var e=this.getSize(a),e=this._formatSize(e);void 0!==b&&void 0!==c&&(e=this._formatProgress(b,c));this._templating.updateSize(a,e)},_formatProgress:function(a,b){var c=this._options.text.formatProgress,e=Math.round(100*(a/b)),c=c.replace("{percent}",e),e=this._formatSize(b);return c=c.replace("{total_size}",e)},_controlFailureTextDisplay:function(a,b){var c,e,d,f,
g;c=this._options.failedUploadTextDisplay.mode;e=this._options.failedUploadTextDisplay.maxChars;d=this._options.failedUploadTextDisplay.responseProperty;"custom"===c?(f=b[d],f?f.length>e&&(g=f.substring(0,e)+"..."):(f=this._options.text.failUpload,this.log("'"+d+"' is not a valid property on the server response.","warn")),this._templating.setStatusText(a,g||f),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(a,f)):"default"===c?this._templating.setStatusText(a,this._options.text.failUpload):
"none"!==c&&this.log("failedUploadTextDisplay.mode value of '"+c+"' is not valid","warn")},_showTooltip:function(a,b){this._templating.getFileContainer(a).title=b},_showCancelLink:function(a){(!this._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&this._templating.showCancel(a)},_itemError:function(){var a=this._parent.prototype._itemError.apply(this,arguments);this._options.showMessage(a)},_batchError:function(a){this._parent.prototype._batchError.apply(this,arguments);
this._options.showMessage(a)},_setupPastePrompt:function(){var a=this;this._options.callbacks.onPasteReceived=function(){return a._options.showPrompt(a._options.paste.namePromptMessage,a._options.paste.defaultName)}},_fileOrBlobRejected:function(){this._totalFilesInBatch-=1;this._parent.prototype._fileOrBlobRejected.apply(this,arguments)},_prepareItemsForUpload:function(a){this._totalFilesInBatch=a.length;this._filesInBatchAddedToUi=0;this._parent.prototype._prepareItemsForUpload.apply(this,arguments)},
_maybeUpdateThumbnail:function(a){this._templating.updateThumbnail(a,this._thumbnailUrls[a])}};
qq.FineUploader=function(a,b){this._parent=b?qq[b].FineUploaderBasic:qq.FineUploaderBasic;this._parent.apply(this,arguments);qq.extend(this._options,{element:null,button:null,listElement:null,dragAndDrop:{extraDropzones:[]},text:{formatProgress:"{percent}% of {total_size}",failUpload:"Upload failed",waitingForResponse:"Processing..."},template:"qq-template",classes:{retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",success:"qq-upload-success",fail:"qq-upload-fail",editable:"qq-editable",
hide:"qq-hide",dropActive:"qq-upload-drop-area-active"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}..."},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",
deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1,prependFiles:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},thumbnails:{placeholders:{waitUntilResponse:!1,notAvailablePath:null,waitingPath:null}},showMessage:function(a){setTimeout(function(){window.alert(a)},0)},showConfirm:function(a){return window.confirm(a)},showPrompt:function(a,b){return window.prompt(a,b)}},!0);qq.extend(this._options,a,!0);this._templating=new qq.Templating({log:qq.bind(this.log,this),
templateIdOrEl:this._options.template,containerEl:this._options.element,fileContainerEl:this._options.listElement,button:this._options.button,imageGenerator:this._imageGenerator,classes:{hide:this._options.classes.hide,editable:this._options.classes.editable},placeholders:{waitUntilUpdate:this._options.thumbnails.placeholders.waitUntilResponse,thumbnailNotAvailable:this._options.thumbnails.placeholders.notAvailablePath,waitingForThumbnail:this._options.thumbnails.placeholders.waitingPath}});!qq.supportedFeatures.uploading||
this._options.cors.expected&&!qq.supportedFeatures.uploadCors?this._templating.renderFailure(this._options.messages.unsupportedBrowser):(this._wrapCallbacks(),this._templating.render(),this._classes=this._options.classes,!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton()}).getButtonId()),this._setupClickAndEditEventHandlers(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop&&(this._dnd=this._setupDragAndDrop()),this._options.paste.targetElement&&
this._options.paste.promptForName&&(qq.PasteSupport?this._setupPastePrompt():qq.log("Paste support module not found.","info")),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0)};qq.extend(qq.FineUploader.prototype,qq.basePublicApi);qq.extend(qq.FineUploader.prototype,qq.basePrivateApi);qq.extend(qq.FineUploader.prototype,qq.uiPublicApi);qq.extend(qq.FineUploader.prototype,qq.uiPrivateApi);
qq.Templating=function(a){function b(a){return qq(t).getByClass(B+a)[0]}function c(a,b){return qq(a).getByClass(b)[0]}function e(a){return c(b(a),q.progressBarContainer)||c(b(a),q.progressBar)}function d(a){a&&qq(a).addClass(s.classes.hide)}function f(a){a&&qq(a).removeClass(s.classes.hide)}function g(a,b){var c=e(a);c&&!qq(c).hasClass(q.progressBar)&&(c=qq(c).getByClass(q.progressBar)[0]);c&&qq(c).css({width:b+"%"})}function h(a){w?(k(w,a),a.src=w.src,f(a)):d(a)}function i(a){n&&!qq(a).hasAttribute(C)&&
(k(n,a),a.src=n.src,f(a))}function k(a,b){var c=a.style.maxWidth,d=a.style.maxHeight;d&&c&&!b.style.maxWidth&&!b.style.maxHeight&&qq(b).css({maxWidth:c,maxHeight:d})}var l,j,o,m,p,t,u,v,n,w,B="qq-file-id-",C="qq-preview-generated",F=!1,D=-1,s={log:null,templateIdOrEl:"qq-template",containerEl:null,fileContainerEl:null,button:null,imageGenerator:null,classes:{hide:"qq-hide",editable:"qq-editable"},placeholders:{waitUntilUpdate:!1,thumbnailNotAvailable:null,waitingForThumbnail:null}},q={button:"qq-upload-button-selector",
drop:"qq-upload-drop-area-selector",list:"qq-upload-list-selector",progressBarContainer:"qq-progress-bar-container-selector",progressBar:"qq-progress-bar-selector",file:"qq-upload-file-selector",spinner:"qq-upload-spinner-selector",size:"qq-upload-size-selector",cancel:"qq-upload-cancel-selector",deleteButton:"qq-upload-delete-selector",retry:"qq-upload-retry-selector",statusText:"qq-upload-status-text-selector",editFilenameInput:"qq-edit-filename-selector",editNameIcon:"qq-edit-filename-icon-selector",
dropProcessing:"qq-drop-processing-selector",dropProcessingSpinner:"qq-drop-processing-spinner-selector",thumbnail:"qq-thumbnail-selector"};qq.extend(s,a);l=s.log;p=s.containerEl;u=void 0!==s.imageGenerator;var ea,aa,T,Q,ia,ba,U,H,ca;if(l("Parsing template"),null==s.templateIdOrEl)throw Error("You MUST specify either a template element or ID!");if(qq.isString(s.templateIdOrEl)){if(aa=document.getElementById(s.templateIdOrEl),null===aa)throw Error(qq.format("Cannot find template script at ID '{}'!",
s.templateIdOrEl));a=aa.innerHTML}else{if(void 0===s.templateIdOrEl.innerHTML)throw Error("You have specified an invalid value for the template option!  It must be an ID or an Element.");a=s.templateIdOrEl.innerHTML}if(a=qq.trimStr(a),Q=document.createElement("div"),Q.appendChild(qq.toElement(a)),s.button&&(ba=qq(Q).getByClass(q.button)[0],ba&&qq(ba).remove()),qq.DragAndDrop&&qq.supportedFeatures.fileDrop||(ca=qq(Q).getByClass(q.dropProcessing)[0],ca&&qq(ca).remove()),U=qq(Q).getByClass(q.drop)[0],
U&&!qq.DragAndDrop&&(qq.log("DnD module unavailable.","info"),qq(U).remove()),U&&!qq.supportedFeatures.fileDrop&&qq(U).hasAttribute("qq-hide-dropzone")&&qq(U).css({display:"none"}),H=qq(Q).getByClass(q.thumbnail)[0],u?H&&(D=parseInt(H.getAttribute("qq-max-size")),D=0<D?D:null,v=qq(H).hasAttribute("qq-server-scale")):H&&qq(H).remove(),u=u&&H,o=0<qq(Q).getByClass(q.editFilenameInput).length,m=0<qq(Q).getByClass(q.retry).length,T=qq(Q).getByClass(q.list)[0],null==T)throw Error("Could not find the file list container in the template!");
ea=(ia=T.innerHTML,T.innerHTML="",l("Template parsing complete"),{template:qq.trimStr(Q.innerHTML),fileTemplate:qq.trimStr(ia)});var E=s.placeholders.thumbnailNotAvailable,V=s.placeholders.waitingForThumbnail;T={maxSize:D,scale:v};u&&(E&&s.imageGenerator.generate(E,new Image,T).then(function(a){n=a},function(){l("Problem loading 'not available' placeholder image at "+E,"error")}),V&&s.imageGenerator.generate(V,new Image,T).then(function(a){w=a},function(){l("Problem loading 'waiting for thumbnail' placeholder image at "+
V,"error")}));return j={render:function(){l("Rendering template in DOM.");p.innerHTML=ea.template;d(c(p,q.dropProcessing));t=s.fileContainerEl||c(p,q.list);l("Template rendering complete")},renderFailure:function(a){a=qq.toElement(a);p.innerHTML="";p.appendChild(a)},reset:function(){j.render()},clearFiles:function(){t.innerHTML=""},disableCancel:function(){F=!0},addFile:function(a,f,g){var h=qq.toElement(ea.fileTemplate),i=c(h,q.file);qq(h).addClass(B+a);i&&qq(i).setText(f);h.setAttribute("qq-file-id",
a);g?(f=g.index,g=t,i=g.firstChild,0<f&&(i=qq(g).children()[f].nextSibling),g.insertBefore(h,i)):t.appendChild(h);d(e(a));d(c(b(a),q.size));d(c(b(a),q.deleteButton));d(c(b(a),q.retry));F&&j.hideCancel(a)},removeFile:function(a){qq(b(a)).remove()},getFileId:function(a){for(;null==a.getAttribute("qq-file-id");)a=a.parentNode;return parseInt(a.getAttribute("qq-file-id"))},getFileList:function(){return t},markFilenameEditable:function(a){(a=c(b(a),q.file))&&qq(a).addClass(s.classes.editable)},updateFilename:function(a,
d){var e=c(b(a),q.file);e&&qq(e).setText(d)},hideFilename:function(a){d(c(b(a),q.file))},showFilename:function(a){f(c(b(a),q.file))},isFileName:function(a){return qq(a).hasClass(q.file)},getButton:function(){return s.button||c(p,q.button)},hideDropProcessing:function(){d(c(p,q.dropProcessing))},showDropProcessing:function(){f(c(p,q.dropProcessing))},getDropZone:function(){return c(p,q.drop)},isEditFilenamePossible:function(){return o},isRetryPossible:function(){return m},getFileContainer:function(a){return b(a)},
showEditIcon:function(a){(a=c(b(a),q.editNameIcon))&&qq(a).addClass(s.classes.editable)},hideEditIcon:function(a){(a=c(b(a),q.editNameIcon))&&qq(a).removeClass(s.classes.editable)},isEditIcon:function(a){return qq(a).hasClass(q.editNameIcon)},getEditInput:function(a){return c(b(a),q.editFilenameInput)},isEditInput:function(a){return qq(a).hasClass(q.editFilenameInput)},updateProgress:function(a,b,c){var h,i=e(a);i&&(h=Math.round(100*(b/c)),b===c?d(i):f(i),g(a,h))},hideProgress:function(a){(a=e(a))&&
d(a)},resetProgress:function(a){g(a,0)},showCancel:function(a){F||(a=c(b(a),q.cancel))&&qq(a).removeClass(s.classes.hide)},hideCancel:function(a){d(c(b(a),q.cancel))},isCancel:function(a){return qq(a).hasClass(q.cancel)},showDelete:function(a){f(c(b(a),q.deleteButton))},hideDelete:function(a){d(c(b(a),q.deleteButton))},isDelete:function(a){return qq(a).hasClass(q.deleteButton)},isRetry:function(a){return qq(a).hasClass(q.retry)},updateSize:function(a,d){var e=c(b(a),q.size);e&&(f(e),qq(e).setText(d))},
setStatusText:function(a,d){var e=c(b(a),q.statusText);e&&(null==d?qq(e).clearText():qq(e).setText(d))},hideSpinner:function(a){d(c(b(a),q.spinner))},showSpinner:function(a){f(c(b(a),q.spinner))},generatePreview:function(a,d){var e=u&&c(b(a),q.thumbnail),g={maxSize:D,scale:!0,orient:!0};if(qq.supportedFeatures.imagePreviews){if(e)return h(e),s.imageGenerator.generate(d,e,g).then(function(){e.setAttribute(C,"true");f(e)},function(){s.placeholders.waitUntilUpdate||i(e)})}else e&&h(e)},updateThumbnail:function(a,
d){var e=u&&c(b(a),q.thumbnail),g={maxSize:D,scale:v};if(e){if(d)return s.imageGenerator.generate(d,e,g).then(function(){f(e)},function(){i(e)});i(e)}}}};
qq.UploadHandlerForm=function(a,b,c,e){var d,f=[],g={};return d=new qq.UploadHandlerFormApi(g,f,a.cors.expected,a.inputName,a.onCancel,c,e),qq.extend(d,{upload:function(c){var i=f[c].input,k=d.getName(c),l=g.createIframe(c);if(!i)throw Error("file with passed id was not added, or already uploaded or cancelled");a.onUpload(c,d.getName(c));var j;j=a.paramsStore.getParams(c);var o=a.demoMode?"GET":"POST",m=a.endpointStore.getEndpoint(c),p=f[c].newName||d.getName(c);j=(j[a.uuidParam]=f[c].uuid,j[a.filenameParam]=
p,g.initFormForUpload({method:o,endpoint:m,params:j,paramsInBody:a.paramsInBody,targetName:l.name}));j.appendChild(i);g.attachLoadEvent(l,function(d){e("iframe loaded");if(!d){var f;try{var i=l.contentDocument||l.contentWindow.document,j=i.body.innerHTML;e("converting iframe's innerHTML to JSON");e("innerHTML = "+j);j&&j.match(/^<pre/i)&&(j=i.body.firstChild.firstChild.nodeValue);f=g.parseJsonResponse(c,j)}catch(p){e("Error when attempting to parse form upload response ("+p.message+")","error"),f=
{success:!1}}d=f}g.detachLoadEvent(c);a.cors.expected||qq(l).remove();(d.success||!a.onAutoRetry(c,k,d))&&(a.onComplete(c,k,d),b(c))});e("Sending upload request for "+c);j.submit();qq(j).remove()}})};
qq.UploadHandlerXhr=function(a,b,c,e){function d(b,c,d,e){var f=new FormData,g=a.demoMode?"GET":"POST",h=a.endpointStore.getEndpoint(e),i=h,k=n[e].newName||t.getName(e),j=t.getSize(e);return b[a.uuidParam]=n[e].uuid,b[a.filenameParam]=k,D&&(b[a.totalFileSizeParam]=j),a.paramsInBody||(D||(b[a.inputName]=k),i=qq.obj2url(b,h)),c.open(g,i,!0),a.cors.expected&&a.cors.sendCredentials&&(c.withCredentials=!0),D?(a.paramsInBody&&qq.obj2FormData(b,f),f.append(a.inputName,d),f):d}function f(b,c){var d=a.customHeaders,
e=n[b].file||n[b].blobData.blob;c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.setRequestHeader("Cache-Control","no-cache");D||(c.setRequestHeader("Content-Type","application/octet-stream"),c.setRequestHeader("X-Mime-Type",e.type));qq.each(d,function(a,b){c.setRequestHeader(a,b)})}function g(b,c,d){var e=t.getName(b),f=t.getSize(b);n[b].attemptingResume=!1;a.onProgress(b,e,f,f);a.onComplete(b,e,c,d);n[b]&&delete n[b].xhr;u(b)}function h(b){var c,e=n[b].remainingChunkIdxs[0],g=s.getChunkData(b,
e),h=s.createXhr(b),i=t.getSize(b),j=t.getName(b);void 0===n[b].loaded&&(n[b].loaded=0);if(C&&n[b].file){c=t.getUuid(b);var p=n[b].loaded,l=n[b].initialRequestOverhead,m=n[b].estTotalRequestsSize,u=o(b);qq.setCookie(u,c+w+g.part+w+p+w+l+w+m,a.resume.cookiesExpireIn)}h.onreadystatechange=k(b,h);h.upload.onprogress=function(c){if(c.lengthComputable){var d=c.loaded+n[b].loaded,c=c.total,f=s.getChunkData(b,e),c=c-f.size,g=t.getSize(b),f=f.count,h=c-n[b].initialRequestOverhead,c=(n[b].lastRequestOverhead=
c,0===e?(n[b].lastChunkIdxProgress=0,n[b].initialRequestOverhead=c,n[b].estTotalRequestsSize=g+f*c):n[b].lastChunkIdxProgress!==e&&(n[b].lastChunkIdxProgress=e,n[b].estTotalRequestsSize+=h),n[b].estTotalRequestsSize);a.onProgress(b,j,d,c)}};a.onUploadChunk(b,j,s.getChunkDataForCallback(g));c=a.paramsStore.getParams(b);p=t.getSize(b);l=t.getName(b);c[a.chunking.paramNames.partIndex]=g.part;c[a.chunking.paramNames.partByteOffset]=g.start;c[a.chunking.paramNames.chunkSize]=g.size;c[a.chunking.paramNames.totalParts]=
g.count;c[a.totalFileSizeParam]=p;D&&(c[a.filenameParam]=l);n[b].attemptingResume&&(c[a.resume.paramNames.resuming]=!0);c=d(c,h,g.blob,b);f(b,h);v("Sending chunked upload request for item "+b+": bytes "+(g.start+1)+"-"+g.end+" of "+i);h.send(c)}function i(a){v("Server has ordered chunking effort to be restarted on next attempt for item ID "+a,"error");C&&(l(a),n[a].attemptingResume=!1);n[a].remainingChunkIdxs=[];delete n[a].loaded;delete n[a].estTotalRequestsSize;delete n[a].initialRequestOverhead}
function k(b,c){return function(){if(4===c.readyState){var d;if(n[b]){v("xhr - server response received for "+b);v("responseText = "+c.responseText);try{v(qq.format("Received response status {} with body: {}",c.status,c.responseText)),d=qq.parseJson(c.responseText),void 0!==d.newUuid&&t.setUuid(b,d.newUuid)}catch(e){v("Error when attempting to parse xhr response text ("+e.message+")","error"),d={}}if(200!==c.status||!d.success||d.reset)if(d.reset&&i(b),n[b].attemptingResume&&d.reset)n[b].attemptingResume=
!1,v("Server has declared that it cannot handle resume for item ID "+b+" - starting from the first chunk","error"),i(b),t.upload(b,!0);else{var f=t.getName(b);a.onAutoRetry(b,f,d,c)||g(b,d,c)}else B?(f=n[b].remainingChunkIdxs.shift(),f=s.getChunkData(b,f),n[b].attemptingResume=!1,n[b].loaded+=f.size+(D?n[b].lastRequestOverhead:0),0<n[b].remainingChunkIdxs.length?h(b):(C&&l(b),g(b,d,c))):g(b,d,c)}}}}function l(a){n[a].file&&(a=o(a),qq.deleteCookie(a))}function j(a){var b,c,d,e,f,g,h=qq.getCookie(o(a)),
a=t.getName(a);if(h){if(b=h.split(w),5===b.length)return c=b[0],d=parseInt(b[1],10),e=parseInt(b[2],10),f=parseInt(b[3],10),g=parseInt(b[4],10),{uuid:c,part:d,lastByteSent:e,initialRequestOverhead:f,estTotalRequestsSize:g};v("Ignoring previously stored resume/chunk cookie for "+a+" - old cookie format","warn")}}function o(b){var c,d=t.getName(b),b=t.getSize(b),e=a.chunking.partSize;return c="qqfilechunk"+w+encodeURIComponent(d)+w+b+w+e,void 0!==F&&(c+=w+F),c}function m(a,b){var c;for(c=s.getTotalChunks(a)-
1;c>=b;c-=1)n[a].remainingChunkIdxs.unshift(c);h(a)}function p(a,b,c,d){c=d.part;n[a].loaded=d.lastByteSent;n[a].estTotalRequestsSize=d.estTotalRequestsSize;n[a].initialRequestOverhead=d.initialRequestOverhead;n[a].attemptingResume=!0;v("Resuming "+b+" at partition index "+c);m(a,c)}var t,u=b,v=e,n=[],w="|",B=a.chunking.enabled&&qq.supportedFeatures.chunking,C=a.resume.enabled&&B&&qq.supportedFeatures.resume,F=null===a.resume.id||void 0===a.resume.id||qq.isFunction(a.resume.id)||qq.isObject(a.resume.id)?
void 0:a.resume.id,D=a.forceMultipart||a.paramsInBody,s={};return t=new qq.UploadHandlerXhrApi(s,n,B?a.chunking:null,function(b,c){var e=t.getName(b);if(t.isValid(b))if(a.onUpload(b,e),B){var g;if(n[b].remainingChunkIdxs&&0!==n[b].remainingChunkIdxs.length)h(b);else if(n[b].remainingChunkIdxs=[],C&&!c&&n[b].file)if(g=j(b)){var i=t.getName(b),e=s.getChunkData(b,g.part),e=a.onResume(b,i,s.getChunkDataForCallback(e));qq.isPromise(e)?(v("Waiting for onResume promise to be fulfilled for "+b),e.then(function(){p(b,
i,0,g)},function(){v("onResume promise fulfilled - failure indicated.  Will not resume.");m(b,0)})):!1!==e?p(b,i,0,g):(v("onResume callback returned false.  Will not resume."),m(b,0))}else m(b,0);else m(b,0)}else{var l,o=n[b].file||n[b].blobData.blob,w=t.getName(b);n[b].loaded=0;e=s.createXhr(b);e.upload.onprogress=function(c){c.lengthComputable&&(n[b].loaded=c.loaded,a.onProgress(b,w,c.loaded,c.total))};e.onreadystatechange=k(b,e);l=a.paramsStore.getParams(b);l=d(l,e,o,b);f(b,e);v("Sending upload request for "+
b);e.send(l)}},a.onCancel,c,v),qq.override(t,function(b){return{add:function(a){var c,a=b.add(a);return C&&(c=j(a),c&&(n[a].uuid=c.uuid)),a},getResumableFilesData:function(){var b=[],c=[];return B&&C?(b=void 0===F?qq.getCookieNames(RegExp("^qqfilechunk\\"+w+".+\\"+w+"\\d+\\"+w+a.chunking.partSize+"=")):qq.getCookieNames(RegExp("^qqfilechunk\\"+w+".+\\"+w+"\\d+\\"+w+a.chunking.partSize+"\\"+w+F+"=")),qq.each(b,function(a,b){var d=b.split(w),e=qq.getCookie(b).split(w);c.push({name:decodeURIComponent(d[1]),
size:d[2],uuid:e[0],partIdx:e[1]})}),c):[]},expunge:function(a){C&&l(a);b.expunge(a)}}}),t};qq.PasteSupport=function(a){var b;b={targetElement:null,callbacks:{log:function(){},pasteReceived:function(){}}};qq.extend(b,a);qq(b.targetElement).attach("paste",function(a){(a=a.clipboardData)&&qq.each(a.items,function(a,c){if(c.type&&0===c.type.indexOf("image/")){var f=c.getAsFile();b.callbacks.pasteReceived(f)}})});return{reset:function(){}}};
qq.DragAndDrop=function(a){function b(a){var c,d=new qq.Promise;return a.isFile?a.file(function(a){g.push(a);d.success()},function(b){e.callbacks.dropLog("Problem parsing '"+a.fullPath+"'.  FileError code "+b.code+".","error");d.failure()}):a.isDirectory&&(c=a.createReader(),c.readEntries(function(a){var c=a.length;qq.each(a,function(a,e){b(e).done(function(){c-=1;0===c&&d.success()})});a.length||d.success()},function(b){e.callbacks.dropLog("Problem parsing '"+a.fullPath+"'.  FileError code "+b.code+
".","error");d.failure()})),d}function c(a){var c=new qq.UploadDropZone({element:a,onEnter:function(b){qq(a).addClass(e.classes.dropActive);b.stopPropagation()},onLeaveNotDescendants:function(){qq(a).removeClass(e.classes.dropActive)},onDrop:function(f){qq(a).hasAttribute(d)&&qq(a).hide();qq(a).removeClass(e.classes.dropActive);var f=f.dataTransfer,h=c,i=[],p=new qq.Promise;(e.callbacks.processingDroppedFiles(),h.dropDisabled(!0),1<f.files.length&&!e.allowMultipleItems?(e.callbacks.processingDroppedFilesComplete([]),
e.callbacks.dropError("tooManyFilesError",""),h.dropDisabled(!1),p.failure()):(g=[],qq.isFolderDropSupported(f)?qq.each(f.items,function(a,c){var d=c.webkitGetAsEntry();d&&(d.isFile?g.push(c.getAsFile()):i.push(b(d).done(function(){i.pop();0===i.length&&p.success()})))}):g=f.files,0===i.length&&p.success()),p).done(function(){var a=g,b=c;e.callbacks.dropLog("Grabbed "+a.length+" dropped files.");b.dropDisabled(!1);e.callbacks.processingDroppedFilesComplete(a)})}});return h.addDisposer(function(){c.dispose()}),
qq(a).hasAttribute(d)&&qq(a).hide(),f.push(c),c}var e,d="qq-hide-dropzone",f=[],g=[],h=new qq.DisposeSupport;e={dropZoneElements:[],allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks};qq.extend(e,a,!0);var i=e.dropZoneElements;qq.each(i,function(a,b){var d=c(b);!i.length||qq.ie()&&!qq.ie10()||h.attach(document,"dragenter",function(a){if(!d.dropDisabled()){var b;(qq.each(a.dataTransfer.types,function(a,c){return"Files"===c?(b=!0,!1):void 0}),b)&&qq.each(i,function(a,
b){qq(b).css({display:"block"})})}})});h.attach(document,"dragleave",function(a){qq.FineUploader.prototype._leaving_document_out(a)&&qq.each(i,function(a,b){qq(b).hasAttribute(d)&&qq(b).hide()})});h.attach(document,"drop",function(a){qq.each(i,function(a,b){qq(b).hasAttribute(d)&&qq(b).hide()});a.preventDefault()});return{setupExtraDropzone:function(a){e.dropZoneElements.push(a);c(a)},removeDropzone:function(a){var b,c=e.dropZoneElements;for(b in c)if(c[b]===a)return c.splice(b,1)},dispose:function(){h.dispose();
qq.each(f,function(a,b){b.dispose()})}}};qq.DragAndDrop.callbacks=function(){return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(){},dropError:function(a,b){qq.log("Drag & drop error code '"+a+" with these specifics: '"+b+"'","error")},dropLog:function(a,b){qq.log(a,b)}}};
qq.UploadDropZone=function(a){function b(){return qq.safari()||qq.firefox()&&qq.windows()}function c(a){if(qq.ie()&&!qq.ie10())return!1;var b,a=a.dataTransfer,c=qq.safari();return b=qq.ie10()?!0:"none"!==a.effectAllowed,a&&b&&(a.files||!c&&a.types.contains&&a.types.contains("Files"))}function e(a){return void 0!==a&&(f=a),f}var d,f,g,h=new qq.DisposeSupport;d={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}};qq.extend(d,a);a=d.element;
g||(b?h.attach(document,"dragover",function(a){a.preventDefault()}):h.attach(document,"dragover",function(a){a.dataTransfer&&(a.dataTransfer.dropEffect="none",a.preventDefault())}),g=!0);h.attach(a,"dragover",function(a){if(c(a)){var b=qq.ie()?null:a.dataTransfer.effectAllowed;a.dataTransfer.dropEffect="move"===b||"linkMove"===b?"move":"copy";a.stopPropagation();a.preventDefault()}});h.attach(a,"dragenter",function(a){if(!e()&&c(a))d.onEnter(a)});h.attach(a,"dragleave",function(a){if(c(a)){d.onLeave(a);
var b=document.elementFromPoint(a.clientX,a.clientY);qq(this).contains(b)||d.onLeaveNotDescendants(a)}});h.attach(a,"drop",function(a){!e()&&c(a)&&(a.preventDefault(),d.onDrop(a))});return{dropDisabled:function(a){return e(a)},dispose:function(){h.dispose()}}};
qq.DeleteFileAjaxRequestor=function(a){var b,c={method:"DELETE",uuidParamName:"qquuid",endpointStore:{},maxConnections:3,customHeaders:{},paramsStore:{},demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(){},onDelete:function(){},onDeleteComplete:function(){}};return qq.extend(c,a),b=new qq.AjaxRequestor({validMethods:["POST","DELETE"],method:c.method,endpointStore:c.endpointStore,paramsStore:c.paramsStore,mandatedParams:"POST"===c.method.toUpperCase()?{_method:"DELETE"}:{},maxConnections:c.maxConnections,
customHeaders:c.customHeaders,demoMode:c.demoMode,log:c.log,onSend:c.onDelete,onComplete:c.onDeleteComplete,cors:c.cors}),{sendDelete:function(a,d,f){f=f||{};c.log("Submitting delete file request for "+a);"DELETE"===b.getMethod()?b.send(a,d,f):(f[c.uuidParamName]=d,b.send(a,null,f))}}};
(function(){function a(a,b,d,f){var g=a.naturalWidth,h=a.naturalHeight,i=d.width,k=d.height,l=b.getContext("2d");l.save();d=d.orientation;switch(d){case 5:case 6:case 7:case 8:b.width=k;b.height=i;break;default:b.width=i,b.height=k}b=b.getContext("2d");switch(d){case 2:b.translate(i,0);b.scale(-1,1);break;case 3:b.translate(i,k);b.rotate(Math.PI);break;case 4:b.translate(0,k);b.scale(1,-1);break;case 5:b.rotate(0.5*Math.PI);b.scale(1,-1);break;case 6:b.rotate(0.5*Math.PI);b.translate(0,-k);break;
case 7:b.rotate(0.5*Math.PI);b.translate(i,-k);b.scale(-1,1);break;case 8:b.rotate(-0.5*Math.PI),b.translate(-i,0)}if(qq.ios()){b=a.naturalWidth;1048576<b*a.naturalHeight?(d=document.createElement("canvas"),d.width=d.height=1,d=d.getContext("2d"),b=(d.drawImage(a,-b+1,0),0===d.getImageData(0,0,1,1).data[3])):b=!1;b&&(g/=2,h/=2);b=document.createElement("canvas");b.width=b.height=1024;d=b.getContext("2d");if(f){var f=h,j=document.createElement("canvas");j.width=1;j.height=f;j=j.getContext("2d");j.drawImage(a,
0,0);for(var j=j.getImageData(0,0,1,f).data,o=0,m=f,p=f;p>o;)0===j[4*(p-1)+3]?m=p:o=p,p=m+o>>1;f=p/f;f=0===f?1:f}else f=1;i=Math.ceil(1024*i/g);k=Math.ceil(1024*k/h/f);for(j=f=0;h>f;){for(m=o=0;g>o;)d.clearRect(0,0,1024,1024),d.drawImage(a,-o,-f),l.drawImage(b,0,0,1024,1024,m,j,i,k),o+=1024,m+=i;f+=1024;j+=k}l.restore()}else l.drawImage(a,0,0,i,k)}function b(a,b){if(window.Blob&&a instanceof Blob){var d=new Image,f=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?
window.webkitURL:null;if(!f)throw Error("No createObjectURL function found to create blob url");d.src=f.createObjectURL(a);this.blob=a;a=d}if(!a.naturalWidth&&!a.naturalHeight){var g=this;a.onload=function(){var a=g.imageLoadListeners;if(a){g.imageLoadListeners=null;for(var b=0,c=a.length;c>b;b++)a[b]()}};a.onerror=b;this.imageLoadListeners=[]}this.srcImage=a}b.prototype.render=function(b,e){if(this.imageLoadListeners){var d=this;return this.imageLoadListeners.push(function(){d.render(b,e)}),void 0}var e=
e||{},f=this.srcImage.naturalWidth,g=this.srcImage.naturalHeight,h=e.width,i=e.height,k=e.maxWidth,l=e.maxHeight,j=!this.blob||"image/jpeg"===this.blob.type;h&&!i?i=g*h/f<<0:i&&!h?h=f*i/g<<0:(h=f,i=g);k&&h>k&&(h=k,i=g*h/f<<0);l&&i>l&&(i=l,h=f*i/g<<0);var f={width:h,height:i},o;for(o in e)f[o]=e[o];o=b.tagName.toLowerCase();"img"===o?(o=this.srcImage,g=document.createElement("canvas"),h=f.mime||"image/jpeg",j=(a(o,g,f,j),g.toDataURL(h,f.quality||0.8)),b.src=j):"canvas"===o&&a(this.srcImage,b,f,j);
"function"==typeof this.onrender&&this.onrender(b)};"function"==typeof define&&define.amd?define([],function(){return b}):this.MegaPixImage=b})();
qq.ImageGenerator=function(a){function b(a){return"img"===a.tagName.toLowerCase()}function c(a){return"canvas"===a.tagName.toLowerCase()}function e(a){a=a.split("/");a=qq.getExtension(a[a.length-1]);switch(a&&a.toLowerCase()){case "jpeg":case "jpg":return"image/jpeg";case "png":return"image/png";case "bmp":return"image/bmp";case "gif":return"image/gif";case "tiff":case "tif":return"image/tiff"}}function d(a){var b,c,d,e=document.createElement("a");return e.href=a,b=e.protocol,d=e.port,c=e.hostname,
b.toLowerCase()!==window.location.protocol.toLowerCase()?!0:c.toLowerCase()!==window.location.hostname.toLowerCase()?!0:d===window.location.port||qq.ie()?!1:!0}function f(d,e){var f=b||c;if(b(d))d.onload=function(){d.onload=null;d.onerror=null;e.success(d)},d.onerror=function(){d.onload=null;d.onerror=null;a("Problem drawing preview!","error");e.failure(d,"Problem drawing preview!")};else if(c(d)){var g=d.getContext("2d"),h=g.drawImage;g.drawImage=function(){h.apply(this,arguments);e.success(d);g.drawImage=
h}}else e.fail(d),a(qq.format("Element container of type {} is not supported!",d.tagName),"error");return f}function g(a,b,c,g){var h=new Image,i=new qq.Promise;f(h,i);d(a)&&(h.crossOrigin="anonymous");h.src=a;i.then(function(){f(b,c);(new MegaPixImage(h)).render(b,{maxWidth:g,maxHeight:g,mime:e(a)})})}function h(a,b,c,d){f(b,c);qq(b).css({maxWidth:d+"px",maxHeight:d+"px"});b.src=a}var i;return i={generate:function(e,i,j){if(qq.isString(e)){a("Attempting to update thumbnail based on server response.");
var o=j||{},j=new qq.Promise,m=o.scale,o=m?o.maxSize:null;m&&b(i)?(m=document.createElement("canvas"),m.getContext&&m.getContext("2d")?d(e)&&void 0===(new Image).crossOrigin?h(e,i,j,o):g(e,i,j,o):h(e,i,j,o)):c(i)?g(e,i,j,o):f(i,j)&&(i.src=e)}else{a("Attempting to draw client-side image preview.");var j=j||{},p=new qq.Promise,m=new qq.Identify(e,a),t=j.maxSize,u=function(){p.failure(i,"Browser cannot render image!")},j=(m.isPreviewable().then(function(b){var c=new qq.Exif(e,a),d=new MegaPixImage(e,
u);f(i,p)&&c.parse().then(function(a){d.render(i,{maxWidth:t,maxHeight:t,orientation:a.Orientation,mime:b})},function(c){a(qq.format("EXIF data could not be parsed ({}).  Assuming orientation = 1.",c));d.render(i,{maxWidth:t,maxHeight:t,mime:b})})},function(){a("Not previewable");p.failure(i,"Not previewable")}),p)}return j}},i._testing={},i._testing.isImg=b,i._testing.isCanvas=c,i._testing.isCrossOrigin=d,i._testing.determineMimeOfFileName=e,i};
qq.Exif=function(a,b){function c(a){for(var b=0,c=0;0<a.length;)b+=parseInt(a.substring(0,2),16)*Math.pow(2,c),a=a.substring(2,a.length),c+=8;return b}function e(b,c){var d=b,f=c;return void 0===d&&(d=2,f=new qq.Promise),qq.readBlobToHex(a,d,4).then(function(a){var b=/^ffe([0-9])/.exec(a);b?"1"!==b[1]?(a=parseInt(a.slice(4,8),16),e(d+a+2,f)):f.success(d):f.failure("No EXIF header to be found!")}),f}var d,f=[274],g={274:{name:"Orientation",bytes:2}};return d={parse:function(){var d=new qq.Promise,
i=function(a){b(qq.format("EXIF header parse failed: '{}' ",a));d.failure(a)},k=new qq.Promise;return(qq.readBlobToHex(a,0,6).then(function(a){0!==a.indexOf("ffd8")?k.failure("Not a valid JPEG!"):e().then(function(a){k.success(a)},function(a){k.failure(a)})}),k).then(function(e){b(qq.format("Moving forward with EXIF header parsing for '{}'",void 0===a.name?"blob":a.name));var j=new qq.Promise;(qq.readBlobToHex(a,e+10,2).then(function(a){j.success("4949"===a)}),j).then(function(j){b(qq.format("EXIF Byte order is {} endian",
j?"little":"big"));var k=new qq.Promise;(qq.readBlobToHex(a,e+18,2).then(function(a){return j?k.success(c(a)):(k.success(parseInt(a,16)),void 0)}),k).then(function(p){b(qq.format("Found {} APP1 directory entries",p));qq.readBlobToHex(a,e+20,12*p).then(function(a){for(var e=[],i=0;i+24<=a.length;)e.push(a.slice(i,i+24)),i+=24;var p=qq.extend([],f),k={},a=(qq.each(e,function(a,b){var d,e,f,h=b.slice(0,4),h=j?c(h):parseInt(h,16),i=p.indexOf(h);return 0<=i&&(e=g[h].name,f=g[h].bytes,d=b.slice(16,16+2*
f),k[e]=j?c(d):parseInt(d,16),p.splice(i,1)),0===p.length?!1:void 0}),k);b("Successfully parsed some EXIF tags");d.success(a)},i)},i)},i)},i),d}},d._testing={},d._testing.parseLittleEndian=c,d};
qq.Identify=function(a,b){var c={"image/jpeg":"ffd8ff","image/gif":"474946","image/png":"89504e","image/bmp":"424d","image/tiff":["49492a00","4d4d002a"]};return{isPreviewable:function(){var e=new qq.Promise,d=!1,f=void 0===a.name?"blob":a.name;return b(qq.format("Attempting to determine if {} can be rendered in this browser",f)),qq.readBlobToHex(a,0,4).then(function(a){qq.each(c,function(b,c){var f=!1,l=[].concat(c);return(qq.each(l,function(b,c){return 0===a.indexOf(c)?(f=!0,!1):void 0}),f)?(("image/tiff"!==
b||qq.safari())&&(d=!0,e.success(b)),!1):void 0});b(qq.format("'{}' is {} able to be rendered in this browser",f,d?"":"NOT"));d||e.failure()}),e}}};
qq.UiEventHandler=function(a,b){function c(a){e.attach(a,d.eventType,function(a){a=a||window.event;d.onHandled(a.target||a.srcElement,a)})}var e=new qq.DisposeSupport,d={eventType:"click",attachTo:null,onHandled:function(){}};return qq.extend(b,{getFileIdFromItem:function(a){return a.qqFileId},getDisposeSupport:function(){return e}}),qq.extend(d,a),d.attachTo&&c(d.attachTo),{addHandler:function(a){c(a)},dispose:function(){e.dispose()}}};
qq.DeleteRetryOrCancelClickHandler=function(a){var b={templating:null,log:function(){},classes:{cancel:"qq-upload-cancel",deleteButton:"qq-upload-delete",retry:"qq-upload-retry"},onDeleteFile:function(){},onCancel:function(){},onRetry:function(){},onGetName:function(){}};qq.extend(b,a);b.eventType="click";b.onHandled=function(a,e){if(b.templating.isCancel(a)||b.templating.isRetry(a)||b.templating.isDelete(a)){var d=b.templating.getFileId(a);qq.preventDefault(e);b.log(qq.format("Detected valid cancel, retry, or delete click event on file '{}', ID: {}.",
b.onGetName(d),d));b.templating.isDelete(a)?b.onDeleteFile(d):b.templating.isCancel(a)?b.onCancel(d):b.onRetry(d)}};b.attachTo=b.templating.getFileList();qq.extend(this,new qq.UiEventHandler(b,{}))};
qq.FilenameClickHandler=function(a){var b={},c={templating:null,log:function(){},classes:{file:"qq-upload-file",editNameIcon:"qq-edit-filename-icon"},onGetUploadStatus:function(){},onGetName:function(){}};return qq.extend(c,a),c.eventType="click",c.onHandled=function(a,d){if(c.templating.isFileName(a)||c.templating.isEditIcon(a)){var f=c.templating.getFileId(a);c.onGetUploadStatus(f)===qq.status.SUBMITTED&&(c.log(qq.format("Detected valid filename click event on file '{}', ID: {}.",c.onGetName(f),
f)),qq.preventDefault(d),b.handleFilenameEdit(f,a,!0))}},qq.extend(this,new qq.FilenameEditHandler(c,b))};
qq.FilenameInputFocusInHandler=function(a,b){var c={templating:null,onGetUploadStatus:function(){},log:function(){}};return b||(b={}),c.eventType="focusin",c.onHandled=function(a){if(c.templating.isEditInput(a)){var d=c.templating.getFileId(a);c.onGetUploadStatus(d)===qq.status.SUBMITTED&&(c.log(qq.format("Detected valid filename input focus event on file '{}', ID: {}.",c.onGetName(d),d)),b.handleFilenameEdit(d,a))}},qq.extend(c,a),qq.extend(this,new qq.FilenameEditHandler(c,b))};
qq.FilenameInputFocusHandler=function(a){return a.eventType="focus",a.attachTo=null,qq.extend(this,new qq.FilenameInputFocusInHandler(a,{}))};
qq.FilenameEditHandler=function(a,b){function c(a,b){var c,e=a.value;void 0!==e&&0<qq.trimStr(e).length&&(c=d.onGetName(b),c=qq.getExtension(c),void 0!==c&&(e=e+"."+c),d.onSetName(b,e));d.onEditingStatusChange(b,!1)}var e,d={templating:null,log:function(){},onGetUploadStatus:function(){},onGetName:function(){},onSetName:function(){},onEditingStatusChange:function(){}};return qq.extend(d,a),d.attachTo=d.templating.getFileList(),e=qq.extend(this,new qq.UiEventHandler(d,b)),qq.extend(b,{handleFilenameEdit:function(a,
e,h){var i=d.templating.getEditInput(a);d.onEditingStatusChange(a,!0);var k,e=d.onGetName(a);k=e.lastIndexOf(".");k=(0<k&&(e=e.substr(0,k)),e);i.value=k;h&&i.focus();b.getDisposeSupport().attach(i,"blur",function(){c(i,a)});b.getDisposeSupport().attach(i,"keyup",function(b){13===(b.keyCode||b.which)&&c(i,a)})}}),e};
window.bootbox=window.bootbox||function init(b,c){function e(c,d,e){c.preventDefault();b.isFunction(e)&&!1===e(c)||d.modal("hide")}function d(c,d){var e=0;b.each(c,function(b,c){d(b,c,e++)})}function f(b,c){var d=b.length,e={};if(1>d||2<d)throw Error("Invalid argument length");2===d||"string"===typeof b[0]?(e[c[0]]=b[0],e[c[1]]=b[1]):e=b[0];return e}function g(c,d,e,g){c={className:"bootbox-"+c,buttons:h.apply(null,d)};return i(b.extend(!0,{},c,f(g,e)),d)}function h(){for(var b={},c=0,d=arguments.length;c<
d;c++){var e=arguments[c],f=e.toLowerCase(),e=e.toUpperCase(),g=m[j.locale];b[f]={label:g?g[e]:m.en[e]}}return b}function i(b,e){var f={};d(e,function(b,c){f[c]=!0});d(b.buttons,function(b){if(f[b]===c)throw Error("button key "+b+" is not allowed (options are "+e.join("\n")+")");});return b}var k={text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",
select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>"},l=b("body"),j={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0},o={alert:function(){var c;c=g("alert",["ok"],["message","callback"],arguments);if(c.callback&&!b.isFunction(c.callback))throw Error("alert requires callback property to be a function when provided");c.buttons.ok.callback=
c.onEscape=function(){return b.isFunction(c.callback)?c.callback():!0};return o.dialog(c)},confirm:function(){var c;c=g("confirm",["cancel","confirm"],["message","callback"],arguments);c.buttons.cancel.callback=c.onEscape=function(){return c.callback(!1)};c.buttons.confirm.callback=function(){return c.callback(!0)};if(!b.isFunction(c.callback))throw Error("confirm requires a callback");return o.dialog(c)},prompt:function(){var e,g,j,l,n,m;l=b("<form class='bootbox-form'></form>");g={className:"bootbox-prompt",
buttons:h("cancel","confirm"),value:"",inputType:"text"};e=i(b.extend(!0,{},g,f(arguments,["title","callback"])),["cancel","confirm"]);g=e.show===c?!0:e.show;e.message=l;e.buttons.cancel.callback=e.onEscape=function(){return e.callback(null)};e.buttons.confirm.callback=function(){var c;switch(e.inputType){case "text":case "email":case "select":c=n.val();break;case "checkbox":var f=n.find("input:checked");c=[];d(f,function(d,e){c.push(b(e).val())})}return e.callback(c)};e.show=!1;if(!e.title)throw Error("prompt requires a title");
if(!b.isFunction(e.callback))throw Error("prompt requires a callback");if(!k[e.inputType])throw Error("invalid prompt type");n=b(k[e.inputType]);switch(e.inputType){case "text":case "email":n.val(e.value);break;case "select":var B={};m=e.inputOptions||[];if(!m.length)throw Error("prompt with select requires options");d(m,function(d,e){var f=n;if(e.value===c||e.text===c)throw Error("given options in wrong format");e.group&&(B[e.group]||(B[e.group]=b("<optgroup/>").attr("label",e.group)),f=B[e.group]);
f.append("<option value='"+e.value+"'>"+e.text+"</option>")});d(B,function(b,c){n.append(c)});n.val(e.value);break;case "checkbox":var C=b.isArray(e.value)?e.value:[e.value];m=e.inputOptions||[];if(!m.length)throw Error("prompt with checkbox requires options");if(!m[0].value||!m[0].text)throw Error("given options in wrong format");n=b("<div/>");d(m,function(c,f){var g=b(k[e.inputType]);g.find("input").attr("value",f.value);g.find("label").append(f.text);d(C,function(b,c){c===f.value&&g.find("input").prop("checked",
!0)});n.append(g)})}e.placeholder&&n.attr("placeholder",e.placeholder);l.append(n);l.on("submit",function(b){b.preventDefault();j.find(".btn-primary").click()});j=o.dialog(e);j.off("shown.bs.modal");j.on("shown.bs.modal",function(){n.focus()});!0===g&&j.modal("show");return j},dialog:function(c){var f,g;if("object"!==typeof c)throw Error("Please supply an object of options");if(!c.message)throw Error("Please specify a message");c=b.extend({},j,c);c.buttons||(c.buttons={});c.backdrop=c.backdrop?"static":
!1;f=c.buttons;var h,i=0;for(h in f)i++;g=i;d(f,function(c,d,e){b.isFunction(d)&&(d=f[c]={callback:d});if(b.type(d)!=="object")throw Error("button with key "+c+" must be an object");if(!d.label)d.label=c;if(!d.className)d.className=g<=2&&e===g-1?"btn-primary":"btn-default"});var k=b("<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>");h=k.find(".modal-body");var m=
"",o={onEscape:c.onEscape};d(c.buttons,function(b,c){m=m+("<button data-bb-handler='"+b+"' type='button' class='btn "+c.className+"'>"+c.label+"</button>");o[b]=c.callback});h.find(".bootbox-body").html(c.message);!0===c.animate&&k.addClass("fade");c.className&&k.addClass(c.className);c.title&&h.before("<div class='modal-header'><h4 class='modal-title'></h4></div>");c.closeButton&&(i=b("<button type='button' class='bootbox-close-button close'>&times;</button>"),c.title?k.find(".modal-header").prepend(i):
i.css("margin-top","-10px").prependTo(h));c.title&&k.find(".modal-title").html(c.title);m.length&&(h.after("<div class='modal-footer'></div>"),k.find(".modal-footer").html(m));k.on("hidden.bs.modal",function(b){b.target===this&&k.remove()});k.on("shown.bs.modal",function(){k.find(".btn-primary:first").focus()});k.on("escape.close.bb",function(b){o.onEscape&&e(b,k,o.onEscape)});k.on("click",".modal-footer button",function(c){var d=b(this).data("bb-handler");e(c,k,o[d])});k.on("click",".bootbox-close-button",
function(b){e(b,k,o.onEscape)});k.on("keyup",function(b){b.which===27&&k.trigger("escape.close.bb")});l.append(k);k.modal({backdrop:c.backdrop,keyboard:!1,show:!1});c.show&&k.modal("show");return k},setDefaults:function(){var c={};2===arguments.length?c[arguments[0]]=arguments[1]:c=arguments[0];b.extend(j,c)},hideAll:function(){b(".bootbox").modal("hide")}},m={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},
en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierd\u017a"},ru:{OK:"OK",CANCEL:"\u041e\u0442\u043c\u0435\u043d\u0430",CONFIRM:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c"},
zh_CN:{OK:"OK",CANCEL:"\u53d6\u6d88",CONFIRM:"\u786e\u8ba4"},zh_TW:{OK:"OK",CANCEL:"\u53d6\u6d88",CONFIRM:"\u78ba\u8a8d"}};o.init=function(c){window.bootbox=init(c||b)};return o}(window.jQuery);
(function(a){function b(){return a("<div/>")}var c=Math.abs,e=Math.max,d=Math.min,f=Math.round;a.imgAreaSelect=function(g,h){function i(a){return a+R.left-O.left}function k(a){return a+R.top-O.top}function l(a){return a-R.left+O.left}function j(a){return a-R.top+O.top}function o(a){var b=a||ja,a=a||ka;return{x1:f(r.x1*b),y1:f(r.y1*a),x2:f(r.x2*b),y2:f(r.y2*a),width:f(r.x2*b)-f(r.x1*b),height:f(r.y2*a)-f(r.y1*a)}}function m(a,b,c,d,e){var g=e||ja,e=e||ka;r={x1:f(a/g||0),y1:f(b/e||0),x2:f(c/g||0),y2:f(d/
e||0)};r.width=r.x2-r.x1;r.height=r.y2-r.y1}function p(){ca&&H.width()&&(R={left:f(H.offset().left),top:f(H.offset().top)},P=H.innerWidth(),M=H.innerHeight(),R.top+=H.outerHeight()-M>>1,R.left+=H.outerWidth()-P>>1,la=f(h.minWidth/ja)||0,ma=f(h.minHeight/ka)||0,qa=f(d(h.maxWidth/ja||16777216,P)),ra=f(d(h.maxHeight/ka||16777216,M)),"1.3.2"==a().jquery&&("fixed"==oa&&!sa.getBoundingClientRect)&&(R.top+=e(document.body.scrollTop,sa.scrollTop),R.left+=e(document.body.scrollLeft,sa.scrollLeft)),O=/absolute|relative/.test(fa.css("position"))?
{left:f(fa.offset().left)-fa.scrollLeft(),top:f(fa.offset().top)-fa.scrollTop()}:"fixed"==oa?{left:a(document).scrollLeft(),top:a(document).scrollTop()}:{left:0,top:0},J=i(0),K=k(0),(r.x2>P||r.y2>M)&&F())}function t(b){if(pa){E.css({left:i(r.x1),top:k(r.y1)}).add(V).width(W=r.width).height(da=r.height);V.add(L).add(I).css({left:0,top:0});L.width(e(W-L.outerWidth()+L.innerWidth(),0)).height(e(da-L.outerHeight()+L.innerHeight(),0));a(G[0]).css({left:J,top:K,width:r.x1,height:M});a(G[1]).css({left:J+
r.x1,top:K,width:W,height:r.y1});a(G[2]).css({left:J+r.x2,top:K,width:P-r.x2,height:M});a(G[3]).css({left:J+r.x1,top:K+r.y2,width:W,height:M-r.y2});W-=I.outerWidth();da-=I.outerHeight();switch(I.length){case 8:a(I[4]).css({left:W>>1}),a(I[5]).css({left:W,top:da>>1}),a(I[6]).css({left:W>>1,top:da}),a(I[7]).css({top:da>>1});case 4:I.slice(1,3).css({left:W}),I.slice(2,4).css({top:da})}if(!1!==b&&(a.imgAreaSelect.onKeyPress!=wa&&a(document).unbind(a.imgAreaSelect.keyPress,a.imgAreaSelect.onKeyPress),
h.keys))a(document)[a.imgAreaSelect.keyPress](a.imgAreaSelect.onKeyPress=wa);ga&&2==L.outerWidth()-L.innerWidth()&&(L.css("margin",0),setTimeout(function(){L.css("margin","auto")},0))}}function u(a){p();t(a);x=i(r.x1);y=k(r.y1);z=i(r.x2);A=k(r.y2)}function v(a,b){h.fadeSpeed?a.fadeOut(h.fadeSpeed,b):a.hide()}function n(a){var b=l(a.pageX-O.left)-r.x1,a=j(a.pageY-O.top)-r.y1;ta||(p(),ta=!0,E.one("mouseout",function(){ta=!1}));N="";h.resizable&&(a<=h.resizeMargin?N="n":a>=r.height-h.resizeMargin&&(N=
"s"),b<=h.resizeMargin?N+="w":b>=r.width-h.resizeMargin&&(N+="e"));E.css("cursor",N?N+"-resize":h.movable?"move":"");na&&na.toggle()}function w(){a("body").css("cursor","");(h.autoHide||0==r.width*r.height)&&v(E.add(G),function(){a(this).hide()});a(document).unbind("mousemove",D);E.mousemove(n);h.onSelectEnd(g,o())}function B(b){if(1!=b.which)return!1;p();N?(a("body").css("cursor",N+"-resize"),x=i(r[/w/.test(N)?"x2":"x1"]),y=k(r[/n/.test(N)?"y2":"y1"]),a(document).mousemove(D).one("mouseup",w),E.unbind("mousemove",
n)):h.movable?(ua=J+r.x1-(b.pageX-O.left),va=K+r.y1-(b.pageY-O.top),E.unbind("mousemove",n),a(document).mousemove(q).one("mouseup",function(){h.onSelectEnd(g,o());a(document).unbind("mousemove",q);E.mousemove(n)})):H.mousedown(b);return!1}function C(a){Y&&(a?(z=e(J,d(J+P,x+c(A-y)*Y*(z>x||-1))),A=f(e(K,d(K+M,y+c(z-x)/Y*(A>y||-1)))),z=f(z)):(A=e(K,d(K+M,y+c(z-x)/Y*(A>y||-1))),z=f(e(J,d(J+P,x+c(A-y)*Y*(z>x||-1)))),A=f(A)))}function F(){x=d(x,J+P);y=d(y,K+M);c(z-x)<la&&(z=x-la*(z<x||-1),z<J?x=J+la:z>
J+P&&(x=J+P-la));c(A-y)<ma&&(A=y-ma*(A<y||-1),A<K?y=K+ma:A>K+M&&(y=K+M-ma));z=e(J,d(z,J+P));A=e(K,d(A,K+M));C(c(z-x)<c(A-y)*Y);c(z-x)>qa&&(z=x-qa*(z<x||-1),C());c(A-y)>ra&&(A=y-ra*(A<y||-1),C(!0));r={x1:l(d(x,z)),x2:l(e(x,z)),y1:j(d(y,A)),y2:j(e(y,A)),width:c(z-x),height:c(A-y)};t();h.onSelectChange(g,o())}function D(a){z=/w|e|^$/.test(N)||Y?a.pageX-O.left:i(r.x2);A=/n|s|^$/.test(N)||Y?a.pageY-O.top:k(r.y2);F();return!1}function s(b,c){z=(x=b)+r.width;A=(y=c)+r.height;a.extend(r,{x1:l(x),y1:j(y),
x2:l(z),y2:j(A)});t();h.onSelectChange(g,o())}function q(a){x=e(J,d(ua+(a.pageX-O.left),J+P-r.width));y=e(K,d(va+(a.pageY-O.top),K+M-r.height));s(x,y);a.preventDefault();return!1}function ea(){a(document).unbind("mousemove",ea);p();z=x;A=y;F();N="";G.is(":visible")||E.add(G).hide().fadeIn(h.fadeSpeed||0);pa=!0;a(document).unbind("mouseup",aa).mousemove(D).one("mouseup",w);E.unbind("mousemove",n);h.onSelectStart(g,o())}function aa(){a(document).unbind("mousemove",ea).unbind("mouseup",aa);v(E.add(G));
m(l(x),j(y),l(x),j(y));this instanceof a.imgAreaSelect||(h.onSelectChange(g,o()),h.onSelectEnd(g,o()));h.onCancelSelection(g)}function T(b){if(1!=b.which||G.is(":animated"))return!1;p();ua=x=b.pageX-O.left;va=y=b.pageY-O.top;a(document).mousemove(ea).mouseup(aa);return!1}function Q(){u(!1)}function ia(){ca=!0;U(h=a.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onCancelSelection:function(){},
onSelectEnd:function(){}},h));E.add(G).css({visibility:""});h.show&&(pa=!0,p(),t(),E.add(G).hide().fadeIn(h.fadeSpeed||0));setTimeout(function(){h.onInit(g,o())},0)}function ba(a,b){for(var c in b)void 0!==h[c]&&a.css(b[c],h[c])}function U(c){c.parent&&(fa=a(c.parent)).append(E.add(G));a.extend(h,c);p();if(null!=c.handles){I.remove();I=a([]);for(ha=c.handles?"corners"==c.handles?4:8:0;ha--;)I=I.add(b());I.addClass(h.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:Z+1||1});0<=!parseInt(I.css("width"))&&
I.width(5).height(5);(X=h.borderWidth)&&I.css({borderWidth:X,borderStyle:"solid"});ba(I,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}ja=h.imageWidth/P||1;ka=h.imageHeight/M||1;null!=c.x1&&(m(c.x1,c.y1,c.x2,c.y2),c.show=!c.hide);c.keys&&(h.keys=a.extend({shift:1,ctrl:"resize"},c.keys));G.addClass(h.classPrefix+"-outer");V.addClass(h.classPrefix+"-selection");for(ha=0;4>ha++;)a(L[ha-1]).addClass(h.classPrefix+"-border"+ha);ba(V,{selectionColor:"background-color",
selectionOpacity:"opacity"});ba(L,{borderOpacity:"opacity",borderWidth:"border-width"});ba(G,{outerColor:"background-color",outerOpacity:"opacity"});(X=h.borderColor1)&&a(L[0]).css({borderStyle:"solid",borderColor:X});(X=h.borderColor2)&&a(L[1]).css({borderStyle:"dashed",borderColor:X});E.append(V.add(L).add(na)).append(I);ga&&((X=(G.css("filter")||"").match(/opacity=(\d+)/))&&G.css("opacity",X[1]/100),(X=(L.css("filter")||"").match(/opacity=(\d+)/))&&L.css("opacity",X[1]/100));c.hide?v(E.add(G)):
c.show&&ca&&(pa=!0,E.add(G).fadeIn(h.fadeSpeed||0),u());Y=(xa=(h.aspectRatio||"").split(/:/))[0]/xa[1];H.add(G).unbind("mousedown",T);if(h.disable||!1===h.enable)E.unbind("mousemove",n).unbind("mousedown",B),a(window).unbind("resize",Q);else{if(h.enable||!1===h.disable)(h.resizable||h.movable)&&E.mousemove(n).mousedown(B),a(window).resize(Q);h.persistent||H.add(G).mousedown(T)}h.enable=h.disable=void 0}var H=a(g),ca,E=b(),V=b(),L=b().add(b()).add(b()).add(b()),G=b().add(b()).add(b()).add(b()),I=a([]),
na,J,K,R={left:0,top:0},P,M,fa,O={left:0,top:0},Z=0,oa="absolute",ua,va,ja,ka,N,la,ma,qa,ra,Y,pa,x,y,z,A,r={x1:0,y1:0,x2:0,y2:0,width:0,height:0},sa=document.documentElement,S=navigator.userAgent,xa,ha,X,W,da,ta,wa=function(a){var b=h.keys,c,f=a.keyCode;c=!isNaN(b.alt)&&(a.altKey||a.originalEvent.altKey)?b.alt:!isNaN(b.ctrl)&&a.ctrlKey?b.ctrl:!isNaN(b.shift)&&a.shiftKey?b.shift:!isNaN(b.arrows)?b.arrows:10;if("resize"==b.arrows||"resize"==b.shift&&a.shiftKey||"resize"==b.ctrl&&a.ctrlKey||"resize"==
b.alt&&(a.altKey||a.originalEvent.altKey)){switch(f){case 37:c=-c;case 39:a=e(x,z);x=d(x,z);z=e(a+c,x);C();break;case 38:c=-c;case 40:a=e(y,A);y=d(y,A);A=e(a+c,y);C(!0);break;default:return}F()}else switch(x=d(x,z),y=d(y,A),f){case 37:s(e(x-c,J),y);break;case 38:s(x,e(y-c,K));break;case 39:s(x+d(c,P-l(z)),y);break;case 40:s(x,y+d(c,M-j(A)));break;default:return}return!1};this.remove=function(){U({disable:!0});E.add(G).remove()};this.getOptions=function(){return h};this.setOptions=U;this.getSelection=
o;this.setSelection=m;this.cancelSelection=aa;this.update=u;for(var ga=(/msie ([\w.]+)/i.exec(S)||[])[1],ya=/opera/i.test(S),za=/webkit/i.test(S)&&!/chrome/i.test(S),S=H;S.length;)Z=e(Z,!isNaN(S.css("z-index"))?S.css("z-index"):Z),"fixed"==S.css("position")&&(oa="fixed"),S=S.parent(":not(body)");Z=h.zIndex||Z;ga&&H.attr("unselectable","on");a.imgAreaSelect.keyPress=ga||za?"keydown":"keypress";ya&&(na=b().css({width:"100%",height:"100%",position:"absolute",zIndex:Z+2||2}));E.add(G).css({visibility:"hidden",
position:oa,overflow:"hidden",zIndex:Z||"0"});E.css({zIndex:Z+2||2});V.add(L).css({position:"absolute",fontSize:0});g.complete||"complete"==g.readyState||!H.is("img")?ia():H.one("load",ia);!ca&&(ga&&7<=ga)&&(g.src=g.src)};a.fn.imgAreaSelect=function(b){b=b||{};this.each(function(){a(this).data("imgAreaSelect")?b.remove?(a(this).data("imgAreaSelect").remove(),a(this).removeData("imgAreaSelect")):a(this).data("imgAreaSelect").setOptions(b):b.remove||(void 0===b.enable&&void 0===b.disable&&(b.enable=
!0),a(this).data("imgAreaSelect",new a.imgAreaSelect(this,b)))});return b.instance?a(this).data("imgAreaSelect"):this}})(jQuery);$(document).ready(function(){createUploader();$("#UserDateOfBirth").datepicker().on("changeDate",function(){$(this).datepicker("hide");$(this).valid()});$(".chosen-select").chosen({no_results_text:"Oops, nothing found!"})});$(document).on("click",".icon-calendar",function(){$("#UserDateOfBirth").datepicker("show")});
$(document).on("click","#cancel_btn",function(){window.location.href="/admin/users/profile"});$(document).on("click",'button[type="submit"]',function(){$("#AdminProfileEditForm").valid()||window.setTimeout("hideDatePicker();",1)});function hideDatePicker(){$("#UserDateOfBirth").blur();$("#UserDateOfBirth").datepicker("hide")}
function createUploader(){$upload_btn=$("#upload_avatar");$messages=$("#uploadmessages");$preview_div=$("#uploadPreview");$preview_img=$("#uploadPreview img");var a=new qq.FineUploaderBasic({button:$upload_btn[0],debug:!1,multiple:!1,request:{endpoint:"/admin/users/photo"},validation:{acceptFiles:"image/*",allowedExtensions:["jpeg","jpg","gif","png"],minSizeLimit:"1024",sizeLimit:"5242880"},callbacks:{onError:function(a,c,e){$messages.html('<div class="alert alert-error">'+e+"</div>");$messages.show();
$upload_btn.show()},onSubmit:function(){$upload_btn.hide();$messages.show();$messages.html('<div class="alert alert-info">onSubmit</div>')},onUpload:function(a,c){var e='<img src="'+app.site_url+'/img/loading.gif" alt="Initializing. Please hold."> Initializing "'+getTruncatedString(c,38)+'"';$messages.html('<div class="alert alert-info">'+e+"</div>")},onProgress:function(a,c,e,d){e<d?(progress=Math.round(100*(e/d))+"% of "+Math.round(d/1024)+" kB",$messages.html('<div class="alert alert-info"><img src="'+
app.site_url+'/img/loading.gif" alt="In progress. Please hold."> Uploading "'+getTruncatedString(c,60)+'" '+progress+"</div>")):$messages.show()},onComplete:function(b,c,e){$upload_btn.show();if(e.success){$messages.hide();var b='<div class="upload_area"><img src="'+e.fileurl+'" alt="Uploaded photo" /></div>',d=bootbox.dialog({closeButton:!1,message:b+'<div>To make adjustments, please drag around the white rectangle below. When you are happy with the photos, click "Accept" button. Your beautiful, clean, non-pixelated image should be at minimum 200x200 pixels.</div>',
title:"Profile Photo",buttons:{success:{label:"Accept",className:"accept btn-success",callback:function(){$.ajax({dataType:"json",type:"POST",url:"/user/register/photo",data:{crop_image:!0,x1:$("#x1").val(),y1:$("#y1").val(),w:$("#w").val(),h:$("#h").val(),cropfileName:e.fileName},beforeSend:function(){$preview_img.attr("src",app.site_url+"img/loading.gif")},success:function(a){$("#cropfileName").val(a.fileName);$preview_img.attr("src",a.fileUrl)}})}},cancel:{label:"Cancel",className:"btn-default",
callback:function(){a.cancelAll()}}}});d.find(".modal-footer .btn-success").attr("disabled","disabled");setTimeout(function(){var a=200;e.imageWidth<a?a=e.imageWidth-2:e.imageHeight<a&&(a=e.imageHeight-2);d.find(".bootbox-body img").imgAreaSelect({parent:".bootbox",autoHide:!1,mustMatch:!0,handles:!0,instance:!0,aspectRatio:"1:1",x1:0,y1:0,x2:a,y2:a,minHeight:a,minWidth:a,onInit:function(){d.find(".modal-footer .btn-success").removeAttr("disabled")},onSelectStart:function(){d.find(".modal-footer .btn-success").removeAttr("disabled")},
onCancelSelection:function(){d.find(".modal-footer .btn-success").attr("disabled","disabled")},onSelectEnd:function(a,b){$("#x1").val(b.x1);$("#y1").val(b.y1);$("#w").val(b.width);$("#h").val(b.height)}})},500)}else $messages.show(),$("#uploadmessages .alert").removeClass("alert-info").addClass("alert-error").html('Error with "'+getTruncatedString(c,38)+'": '+e.error)}}})}function getTruncatedString(a,b){if(a.length>b)var c=a.substring(0,b),c=c+"...";else c=a;return c};